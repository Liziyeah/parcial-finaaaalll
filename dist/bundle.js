/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={9:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,"/* dashboard.css */\n\n:host {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tbackground-color: #ffe4e1; /* Color rosa suave */\n\tfont-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans',\n\t\t'Helvetica Neue', sans-serif;\n\tpadding: 20px;\n\tborder-radius: 15px;\n\tbox-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n\tmax-width: 500px;\n\tmargin: 20px auto;\n}\n\nh1 {\n\tcolor: #ff69b4; /* Color rosa */\n\ttext-align: center;\n\tmargin-bottom: 20px;\n}\n\ninput[type='text'],\ninput[type='color'],\ninput[type='text']::placeholder {\n\tborder: 2px solid #ff69b4;\n\tborder-radius: 10px;\n\tpadding: 10px;\n\tmargin-bottom: 15px;\n\twidth: calc(100% - 24px); /* Consider padding and border */\n\tbox-sizing: border-box;\n\tfont-size: 1em;\n\tbackground-color: #ffffff;\n}\n\ninput[type='color'] {\n\theight: 40px;\n}\n\nbutton {\n\tbackground-color: #ff69b4;\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 10px;\n\tpadding: 10px 20px;\n\tcursor: pointer;\n\tfont-size: 1em;\n\ttransition: background-color 0.3s ease;\n}\n\nbutton:hover {\n\tbackground-color: #ff1493;\n}\n\nstyle {\n\tdisplay: none;\n}\n",""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);r&&o[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},601:t=>{t.exports=function(t){return t[1]}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={id:r,exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{let t={screen:"DASHBOARD"},e=[];const r=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,h=a?t[e+2]:0,c=i>>2,l=(3&i)<<4|o>>4;let u=(15&o)<<2|h>>6,d=63&h;a||(d=64,s||(u=64)),r.push(n[c],n[l],n[u],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let e=0;e<t.length;){const i=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const h=e<t.length?n[t.charAt(e)]:64;if(++e,null==i||null==o||null==a||null==h)throw new s;const c=i<<2|o>>4;if(r.push(c),64!==a){const t=o<<4&240|a>>2;if(r.push(t),64!==h){const t=a<<6&192|h;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){return function(t){const e=r(t);return i.encodeByteArray(e,!0)}(t).replace(/\./g,"")},a=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return i.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},h=()=>{var t;return null===(t=a())||void 0===t?void 0:t.config};class c{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function u(){try{return"object"==typeof indexedDB}catch(t){return!1}}class d extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,d.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,f.prototype.create)}}class f{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],s=i?function(t,e){return t.replace(p,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new d(r,o,n)}}const p=/\{\$([^}]+)}/g;function g(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(m(n)&&m(s)){if(!g(n,s))return!1}else if(n!==s)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function m(t){return null!==t&&"object"==typeof t}function y(t){return t&&t._delegate?t._delegate:t}class v{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const w="[DEFAULT]";class b{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new c;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:w})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=w){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=w){return this.instances.has(t)}getOptions(t=w){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===w?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=w){return this.component?this.component.multipleInstances?t:w:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class E{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new b(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const T=[];var _;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(_||(_={}));const S={debug:_.DEBUG,verbose:_.VERBOSE,info:_.INFO,warn:_.WARN,error:_.ERROR,silent:_.SILENT},I=_.INFO,A={[_.DEBUG]:"log",[_.VERBOSE]:"log",[_.INFO]:"info",[_.WARN]:"warn",[_.ERROR]:"error"},C=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=A[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class D{constructor(t){this.name=t,this._logLevel=I,this._logHandler=C,this._userLogHandler=null,T.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in _))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?S[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,_.DEBUG,...t),this._logHandler(this,_.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,_.VERBOSE,...t),this._logHandler(this,_.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,_.INFO,...t),this._logHandler(this,_.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,_.WARN,...t),this._logHandler(this,_.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,_.ERROR,...t),this._logHandler(this,_.ERROR,...t)}}const N=(t,e)=>e.some((e=>t instanceof e));let k,x;const O=new WeakMap,R=new WeakMap,L=new WeakMap,M=new WeakMap,P=new WeakMap;let V={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return R.get(t);if("objectStoreNames"===e)return t.objectStoreNames||L.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return U(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function F(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(x||(x=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(B(this),t),U(O.get(this))}:function(...t){return U(e.apply(B(this),t))}:function(t,...n){const r=e.call(B(this),t,...n);return L.set(r,t.sort?t.sort():[t]),U(r)}:(t instanceof IDBTransaction&&function(t){if(R.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));R.set(t,e)}(t),N(t,k||(k=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,V):t);var e}function U(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(U(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&O.set(e,t)})).catch((()=>{})),P.set(e,t),e}(t);if(M.has(t))return M.get(t);const e=F(t);return e!==t&&(M.set(t,e),P.set(e,t)),e}const B=t=>P.get(t),j=["get","getKey","getAll","getAllKeys","count"],$=["put","add","delete","clear"],z=new Map;function H(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(z.get(e))return z.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=$.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!j.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&s.done]))[0]};return z.set(e,s),s}var q;q=V,V={...q,get:(t,e,n)=>H(t,e)||q.get(t,e,n),has:(t,e)=>!!H(t,e)||q.has(t,e)};class G{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const K="@firebase/app",Q="0.9.29",W=new D("@firebase/app"),X="@firebase/app-compat",J="@firebase/analytics-compat",Y="@firebase/analytics",Z="@firebase/app-check-compat",tt="@firebase/app-check",et="@firebase/auth",nt="@firebase/auth-compat",rt="@firebase/database",it="@firebase/database-compat",st="@firebase/functions",ot="@firebase/functions-compat",at="@firebase/installations",ht="@firebase/installations-compat",ct="@firebase/messaging",lt="@firebase/messaging-compat",ut="@firebase/performance",dt="@firebase/performance-compat",ft="@firebase/remote-config",pt="@firebase/remote-config-compat",gt="@firebase/storage",mt="@firebase/storage-compat",yt="@firebase/firestore",vt="@firebase/firestore-compat",wt="firebase",bt="[DEFAULT]",Et={[K]:"fire-core",[X]:"fire-core-compat",[Y]:"fire-analytics",[J]:"fire-analytics-compat",[tt]:"fire-app-check",[Z]:"fire-app-check-compat",[et]:"fire-auth",[nt]:"fire-auth-compat",[rt]:"fire-rtdb",[it]:"fire-rtdb-compat",[st]:"fire-fn",[ot]:"fire-fn-compat",[at]:"fire-iid",[ht]:"fire-iid-compat",[ct]:"fire-fcm",[lt]:"fire-fcm-compat",[ut]:"fire-perf",[dt]:"fire-perf-compat",[ft]:"fire-rc",[pt]:"fire-rc-compat",[gt]:"fire-gcs",[mt]:"fire-gcs-compat",[yt]:"fire-fst",[vt]:"fire-fst-compat","fire-js":"fire-js",[wt]:"fire-js-all"},Tt=new Map,_t=new Map;function St(t,e){try{t.container.addComponent(e)}catch(n){W.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function It(t){const e=t.name;if(_t.has(e))return W.debug(`There were multiple attempts to register component ${e}.`),!1;_t.set(e,t);for(const e of Tt.values())St(e,t);return!0}const At=new f("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Ct{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new v("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw At.create("app-deleted",{appName:this._name})}}function Dt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:bt,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw At.create("bad-app-name",{appName:String(i)});if(n||(n=h()),!n)throw At.create("no-options");const s=Tt.get(i);if(s){if(g(n,s.options)&&g(r,s.config))return s;throw At.create("duplicate-app",{appName:i})}const o=new E(i);for(const t of _t.values())o.addComponent(t);const a=new Ct(n,r,o);return Tt.set(i,a),a}function Nt(t,e,n){var r;let i=null!==(r=Et[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void W.warn(t.join(" "))}It(new v(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const kt="firebase-heartbeat-database",xt=1,Ot="firebase-heartbeat-store";let Rt=null;function Lt(){return Rt||(Rt=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=U(o);return r&&o.addEventListener("upgradeneeded",(t=>{r(U(o.result),t.oldVersion,t.newVersion,U(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(kt,xt,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Ot)}catch(t){console.warn(t)}}}).catch((t=>{throw At.create("idb-open",{originalErrorMessage:t.message})}))),Rt}async function Mt(t,e){try{const n=(await Lt()).transaction(Ot,"readwrite"),r=n.objectStore(Ot);await r.put(e,Pt(t)),await n.done}catch(t){if(t instanceof d)W.warn(t.message);else{const e=At.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});W.warn(e.message)}}}function Pt(t){return`${t.name}!${t.options.appId}`}class Vt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Ut(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ft();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((t=>t.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Ft(),{heartbeatsToSend:n,unsentEntries:r}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),Bt(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Bt(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=o(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Ft(){return(new Date).toISOString().substring(0,10)}class Ut{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!u()&&new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Lt()).transaction(Ot),n=await e.objectStore(Ot).get(Pt(t));return await e.done,n}catch(t){if(t instanceof d)W.warn(t.message);else{const e=At.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});W.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Mt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Mt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Bt(t){return o(JSON.stringify({version:2,heartbeats:t})).length}It(new v("platform-logger",(t=>new G(t)),"PRIVATE")),It(new v("heartbeat",(t=>new Vt(t)),"PRIVATE")),Nt(K,Q,""),Nt(K,Q,"esm2017"),Nt("fire-js",""),Nt("firebase","10.9.0","app");var jt,$t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},zt={},Ht=Ht||{},qt=$t||self;function Gt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Kt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Qt="closure_uid_"+(1e9*Math.random()>>>0),Wt=0;function Xt(t,e,n){return t.call.apply(t.bind,arguments)}function Jt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Yt(t,e,n){return(Yt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Xt:Jt).apply(null,arguments)}function Zt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function te(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function ee(){this.s=this.s,this.o=this.o}ee.prototype.s=!1,ee.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Qt)&&t[Qt]||(t[Qt]=++Wt))},ee.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ne=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function re(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function ie(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Gt(n)){const e=t.length||0,r=n.length||0;t.length=e+r;for(let i=0;i<r;i++)t[e+i]=n[i]}else t.push(n)}}function se(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!qt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};qt.addEventListener("test",t,e),qt.removeEventListener("test",t,e)}catch(t){}return t}();function ae(t){return/^[\s\xa0]*$/.test(t)}function he(){var t=qt.navigator;return t&&(t=t.userAgent)?t:""}function ce(t){return-1!=he().indexOf(t)}function le(t){return le[" "](t),t}le[" "]=function(){};var ue,de,fe,pe=ce("Opera"),ge=ce("Trident")||ce("MSIE"),me=ce("Edge"),ye=me||ge,ve=ce("Gecko")&&!(-1!=he().toLowerCase().indexOf("webkit")&&!ce("Edge"))&&!(ce("Trident")||ce("MSIE"))&&!ce("Edge"),we=-1!=he().toLowerCase().indexOf("webkit")&&!ce("Edge");function be(){var t=qt.document;return t?t.documentMode:void 0}t:{var Ee="",Te=(de=he(),ve?/rv:([^\);]+)(\)|;)/.exec(de):me?/Edge\/([\d\.]+)/.exec(de):ge?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(de):we?/WebKit\/(\S+)/.exec(de):pe?/(?:Version)[ \/]?(\S+)/.exec(de):void 0);if(Te&&(Ee=Te?Te[1]:""),ge){var _e=be();if(null!=_e&&_e>parseFloat(Ee)){ue=String(_e);break t}}ue=Ee}qt.document&&ge?fe=be()||parseInt(ue,10)||void 0:fe=void 0;var Se=fe;function Ie(t,e){if(se.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ve){t:{try{le(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ae[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ie.$.h.call(this)}}te(Ie,se);var Ae={2:"touch",3:"pen",4:"mouse"};Ie.prototype.h=function(){Ie.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ce="closure_listenable_"+(1e6*Math.random()|0),De=0;function Ne(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++De,this.fa=this.ia=!1}function ke(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function xe(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Oe(t){const e={};for(const n in t)e[n]=t[n];return e}const Re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Le(t,e){let n,r;for(let e=1;e<arguments.length;e++){for(n in r=arguments[e],r)t[n]=r[n];for(let e=0;e<Re.length;e++)n=Re[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Me(t){this.src=t,this.g={},this.h=0}function Pe(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=ne(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(ke(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ve(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}Me.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Ve(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Ne(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var Fe="closure_lm_"+(1e6*Math.random()|0),Ue={};function Be(t,e,n,r,i){if(r&&r.once)return $e(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Be(t,e[s],n,r,i);return null}return n=We(n),t&&t[Ce]?t.O(e,n,Kt(r)?!!r.capture:!!r,i):je(t,e,n,!1,r,i)}function je(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Kt(i)?!!i.capture:!!i,a=Ke(t);if(a||(t[Fe]=a=new Me(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){const t=Ge;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)oe||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(qe(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function $e(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)$e(t,e[s],n,r,i);return null}return n=We(n),t&&t[Ce]?t.P(e,n,Kt(r)?!!r.capture:!!r,i):je(t,e,n,!0,r,i)}function ze(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)ze(t,e[s],n,r,i);else r=Kt(r)?!!r.capture:!!r,n=We(n),t&&t[Ce]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ve(s=t.g[e],n,r,i))&&(ke(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Ke(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ve(e,n,r,i)),(n=-1<t?e[t]:null)&&He(n))}function He(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Ce])Pe(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(qe(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ke(e))?(Pe(n,t),0==n.h&&(n.src=null,e[Fe]=null)):ke(t)}}}function qe(t){return t in Ue?Ue[t]:Ue[t]="on"+t}function Ge(t,e){if(t.fa)t=!0;else{e=new Ie(e,this);var n=t.listener,r=t.la||t.src;t.ia&&He(t),t=n.call(r,e)}return t}function Ke(t){return(t=t[Fe])instanceof Me?t:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function We(t){return"function"==typeof t?t:(t[Qe]||(t[Qe]=function(e){return t.handleEvent(e)}),t[Qe])}function Xe(){ee.call(this),this.i=new Me(this),this.S=this,this.J=null}function Je(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new se(e,t);else if(e instanceof se)e.target=e.target||t;else{var i=e;Le(e=new se(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Ye(o,r,!0,e)&&i}if(i=Ye(o=e.g=t,r,!0,e)&&i,i=Ye(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Ye(o=e.g=n[s],r,!1,e)&&i}function Ye(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,h=o.la||o.src;o.ia&&Pe(t.i,o),i=!1!==a.call(h,r)&&i}}return i&&!r.defaultPrevented}te(Xe,ee),Xe.prototype[Ce]=!0,Xe.prototype.removeEventListener=function(t,e,n,r){ze(this,t,e,n,r)},Xe.prototype.N=function(){if(Xe.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ke(n[r]);delete e.g[t],e.h--}}this.J=null},Xe.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Xe.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Ze=qt.JSON.stringify;function tn(){var t=hn;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var en=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new nn),(t=>t.reset()));class nn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function rn(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function sn(t){qt.setTimeout((()=>{throw t}),0)}let on,an=!1,hn=new class{constructor(){this.h=this.g=null}add(t,e){const n=en.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},cn=()=>{const t=qt.Promise.resolve(void 0);on=()=>{t.then(ln)}};var ln=()=>{for(var t;t=tn();){try{t.h.call(t.g)}catch(t){sn(t)}var e=en;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}an=!1};function un(t,e){Xe.call(this),this.h=t||1,this.g=e||qt,this.j=Yt(this.qb,this),this.l=Date.now()}function dn(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function fn(t,e,n){if("function"==typeof t)n&&(t=Yt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Yt(t.handleEvent,t)}return 2147483647<Number(e)?-1:qt.setTimeout(t,e||0)}function pn(t){t.g=fn((()=>{t.g=null,t.i&&(t.i=!1,pn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}te(un,Xe),(jt=un.prototype).ga=!1,jt.T=null,jt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Je(this,"tick"),this.ga&&(dn(this),this.start()))}},jt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},jt.N=function(){un.$.N.call(this),dn(this),delete this.g};class gn extends ee{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:pn(this)}N(){super.N(),this.g&&(qt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mn(t){ee.call(this),this.h=t,this.g={}}te(mn,ee);var yn=[];function vn(t,e,n,r){Array.isArray(n)||(n&&(yn[0]=n.toString()),n=yn);for(var i=0;i<n.length;i++){var s=Be(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function wn(t){xe(t.g,(function(t,e){this.g.hasOwnProperty(e)&&He(t)}),t),t.g={}}function bn(){this.g=!0}function En(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ze(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}mn.prototype.N=function(){mn.$.N.call(this),wn(this)},mn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},bn.prototype.Ea=function(){this.g=!1},bn.prototype.info=function(){};var Tn={},_n=null;function Sn(){return _n=_n||new Xe}function In(t){se.call(this,Tn.Ta,t)}function An(t){const e=Sn();Je(e,new In(e))}function Cn(t,e){se.call(this,Tn.STAT_EVENT,t),this.stat=e}function Dn(t){const e=Sn();Je(e,new Cn(e,t))}function Nn(t,e){se.call(this,Tn.Ua,t),this.size=e}function kn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return qt.setTimeout((function(){t()}),e)}Tn.Ta="serverreachability",te(In,se),Tn.STAT_EVENT="statevent",te(Cn,se),Tn.Ua="timingevent",te(Nn,se);var xn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},On={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Rn(){}function Ln(t){return t.h||(t.h=t.i())}function Mn(){}Rn.prototype.h=null;var Pn,Vn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Fn(){se.call(this,"d")}function Un(){se.call(this,"c")}function Bn(){}function jn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new mn(this),this.P=zn,t=ye?125:void 0,this.V=new un(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new $n}function $n(){this.i=null,this.g="",this.h=!1}te(Fn,se),te(Un,se),te(Bn,Rn),Bn.prototype.g=function(){return new XMLHttpRequest},Bn.prototype.i=function(){return{}},Pn=new Bn;var zn=45e3,Hn={},qn={};function Gn(t,e,n){t.L=1,t.A=ur(or(e)),t.u=n,t.S=!0,Kn(t,null)}function Kn(t,e){t.G=Date.now(),Jn(t),t.B=or(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Sr(n.i,"t",r),t.o=0,n=t.l.J,t.h=new $n,t.g=Si(t.l,n?e:null,!t.u),0<t.O&&(t.M=new gn(Yt(t.Pa,t,t.g),t.O)),vn(t.U,t.g,"readystatechange",t.nb),e=t.I?Oe(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),An(),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),h=0;h<a.length;h++){var c=a[h].split("=");if(1<c.length){var l=c[0];c=c[1];var u=l.split("_");o=2<=u.length&&"type"==u[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Qn(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Wn(t,e,n){let r,i=!0;for(;!t.J&&t.o<n.length;){if(r=Xn(t,n),r==qn){4==e&&(t.s=4,Dn(14),i=!1),En(t.j,t.m,null,"[Incomplete Response]");break}if(r==Hn){t.s=4,Dn(15),En(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}En(t.j,t.m,r,null),nr(t,r)}Qn(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,Dn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),mi(e),e.M=!0,Dn(11))):(En(t.j,t.m,n,"[Invalid Chunked Response]"),er(t),tr(t))}function Xn(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?qn:(n=Number(e.substring(n,r)),isNaN(n)?Hn:(r+=1)+n>e.length?qn:(e=e.slice(r,r+n),t.o=r+n,e))}function Jn(t){t.Y=Date.now()+t.P,Yn(t,t.P)}function Yn(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=kn(Yt(t.lb,t),e)}function Zn(t){t.C&&(qt.clearTimeout(t.C),t.C=null)}function tr(t){0==t.l.H||t.J||wi(t.l,t)}function er(t){Zn(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,dn(t.V),wn(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function nr(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||xr(n.i,t)))if(!t.K&&xr(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;vi(n),hi(n)}gi(n),Dn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=kn(Yt(n.ib,n),6e3));if(1>=kr(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Ei(n,11)}else if((t.K||n.g==t)&&vi(n),!ae(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const e=c[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const i=c[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const l=c[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Or(s,s.h),s.h=null))}if(r.F){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.Da=t,lr(r.I,r.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=_i(r,r.J?r.pa:null,r.Y),o.K){Rr(r.i,o);var a=o,h=r.L;h&&a.setTimeout(h),a.C&&(Zn(a),Jn(a)),r.g=o}else pi(r);0<n.j.length&&li(n)}else"stop"!=c[0]&&"close"!=c[0]||Ei(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Ei(n,7):ai(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}An()}catch(t){}}function rr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Gt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Gt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Gt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(jt=jn.prototype).setTimeout=function(t){this.P=t},jt.nb=function(t){t=t.target;const e=this.M;e&&3==ei(t)?e.l():this.Pa(t)},jt.Pa=function(t){try{if(t==this.g)t:{const l=ei(this.g);var e=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||ye||this.g&&(this.h.h||this.g.ja()||ni(this.g)))){this.J||4!=l||7==e||An(),Zn(this);var n=this.g.da();this.ca=n;e:if(Qn(this)){var r=ni(this.g);t="";var i=r.length,s=4==ei(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){er(this),tr(this);var o="";break e}this.h.i=new qt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,h=this.g;if((a=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ae(a)){var c=a;break e}}c=null}if(!(n=c)){this.i=!1,this.s=3,Dn(12),er(this),tr(this);break t}En(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nr(this,n)}this.S?(Wn(this,l,o),ye&&this.i&&3==l&&(vn(this.U,this.V,"tick",this.mb),this.V.start())):(En(this.j,this.m,o,null),nr(this,o)),4==l&&er(this),this.i&&!this.J&&(4==l?wi(this.l,this):(this.i=!1,Jn(this)))}else(function(t){const e={};t=(t.g&&2<=ei(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(ae(t[r]))continue;var n=rn(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Dn(12)):(this.s=0,Dn(13)),er(this),tr(this)}}}catch(t){}},jt.mb=function(){if(this.g){var t=ei(this.g),e=this.g.ja();this.o<e.length&&(Zn(this),Wn(this,t,e),this.i&&4!=t&&Jn(this))}},jt.cancel=function(){this.J=!0,er(this)},jt.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(An(),Dn(17)),er(this),this.s=2,tr(this)):Yn(this,this.Y-t)};var ir=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof sr){this.h=t.h,ar(this,t.j),this.s=t.s,this.g=t.g,hr(this,t.m),this.l=t.l;var e=t.i,n=new br;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),cr(this,n),this.o=t.o}else t&&(e=String(t).match(ir))?(this.h=!1,ar(this,e[1]||"",!0),this.s=dr(e[2]||""),this.g=dr(e[3]||"",!0),hr(this,e[4]),this.l=dr(e[5]||"",!0),cr(this,e[6]||"",!0),this.o=dr(e[7]||"")):(this.h=!1,this.i=new br(null,this.h))}function or(t){return new sr(t)}function ar(t,e,n){t.j=n?dr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function hr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function cr(t,e,n){e instanceof br?(t.i=e,function(t,e){e&&!t.j&&(Er(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Tr(this,e),Sr(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=fr(e,vr)),t.i=new br(e,t.h))}function lr(t,e,n){t.i.set(e,n)}function ur(t){return lr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function dr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,pr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}sr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(fr(e,gr,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(fr(e,gr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(fr(n,"/"==n.charAt(0)?yr:mr,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",fr(n,wr)),t.join("")};var gr=/[#\/\?@]/g,mr=/[#\?:]/g,yr=/[#\?]/g,vr=/[#\?@]/g,wr=/#/g;function br(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Er(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Tr(t,e){Er(t),e=Ir(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function _r(t,e){return Er(t),e=Ir(t,e),t.g.has(e)}function Sr(t,e,n){Tr(t,e),0<n.length&&(t.i=null,t.g.set(Ir(t,e),re(n)),t.h+=n.length)}function Ir(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(jt=br.prototype).add=function(t,e){Er(this),this.i=null,t=Ir(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},jt.forEach=function(t,e){Er(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},jt.ta=function(){Er(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},jt.Z=function(t){Er(this);let e=[];if("string"==typeof t)_r(this,t)&&(e=e.concat(this.g.get(Ir(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},jt.set=function(t,e){return Er(this),this.i=null,_r(this,t=Ir(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},jt.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},jt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var Ar=class{constructor(t,e){this.g=t,this.map=e}};function Cr(t){this.l=t||Dr,t=qt.PerformanceNavigationTiming?0<(t=qt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(qt.g&&qt.g.Ka&&qt.g.Ka()&&qt.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Dr=10;function Nr(t){return!!t.h||!!t.g&&t.g.size>=t.j}function kr(t){return t.h?1:t.g?t.g.size:0}function xr(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Or(t,e){t.g?t.g.add(e):t.h=e}function Rr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Lr(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return re(t.i)}Cr.prototype.cancel=function(){if(this.i=Lr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Mr=class{stringify(t){return qt.JSON.stringify(t,void 0)}parse(t){return qt.JSON.parse(t,void 0)}};function Pr(){this.g=new Mr}function Vr(t,e,n){const r=n||"";try{rr(t,(function(t,n){let i=t;Kt(t)&&(i=Ze(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Fr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Ur(t){this.l=t.ec||null,this.j=t.ob||!1}function Br(t,e){Xe.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=jr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}te(Ur,Rn),Ur.prototype.g=function(){return new Br(this.l,this.j)},Ur.prototype.i=function(t){return function(){return t}}({}),te(Br,Xe);var jr=0;function $r(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function zr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Hr(t)}function Hr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(jt=Br.prototype).open=function(t,e){if(this.readyState!=jr)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Hr(this)},jt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||qt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},jt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,zr(this)),this.readyState=jr},jt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Hr(this)),this.g&&(this.readyState=3,Hr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==qt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;$r(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},jt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?zr(this):Hr(this),3==this.readyState&&$r(this)}},jt.Za=function(t){this.g&&(this.response=this.responseText=t,zr(this))},jt.Ya=function(t){this.g&&(this.response=t,zr(this))},jt.ka=function(){this.g&&zr(this)},jt.setRequestHeader=function(t,e){this.v.append(t,e)},jt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},jt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Br.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var qr=qt.JSON.parse;function Gr(t){Xe.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Kr,this.L=this.M=!1}te(Gr,Xe);var Kr="",Qr=/^https?$/i,Wr=["POST","PUT"];function Xr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Jr(t),Zr(t)}function Jr(t){t.F||(t.F=!0,Je(t,"complete"),Je(t,"error"))}function Yr(t){if(t.h&&void 0!==Ht&&(!t.C[1]||4!=ei(t)||2!=t.da()))if(t.v&&4==ei(t))fn(t.La,0,t);else if(Je(t,"readystatechange"),4==ei(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(ir)[1]||null;!i&&qt.self&&qt.self.location&&(i=qt.self.location.protocol.slice(0,-1)),r=!Qr.test(i?i.toLowerCase():"")}n=r}if(n)Je(t,"complete"),Je(t,"success");else{t.m=6;try{var s=2<ei(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Jr(t)}}finally{Zr(t)}}}function Zr(t,e){if(t.g){ti(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Je(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function ti(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(qt.clearTimeout(t.A),t.A=null)}function ei(t){return t.g?t.g.readyState:0}function ni(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Kr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ri(t){let e="";return xe(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function ii(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=ri(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):lr(t,e,n))}function si(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function oi(t){this.Ga=0,this.j=[],this.l=new bn,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=si("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=si("baseRetryDelayMs",5e3,t),this.hb=si("retryDelaySeedMs",1e4,t),this.eb=si("forwardChannelMaxRetries",2,t),this.xa=si("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Cr(t&&t.concurrentRequestLimit),this.Ja=new Pr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function ai(t){if(ci(t),3==t.H){var e=t.W++,n=or(t.I);if(lr(n,"SID",t.K),lr(n,"RID",e),lr(n,"TYPE","terminate"),di(t,n),(e=new jn(t,t.l,e)).L=2,e.A=ur(or(n)),n=!1,qt.navigator&&qt.navigator.sendBeacon)try{n=qt.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&qt.Image&&((new Image).src=e.A,n=!0),n||(e.g=Si(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Jn(e)}Ti(t)}function hi(t){t.g&&(mi(t),t.g.cancel(),t.g=null)}function ci(t){hi(t),t.u&&(qt.clearTimeout(t.u),t.u=null),vi(t),t.i.cancel(),t.m&&("number"==typeof t.m&&qt.clearTimeout(t.m),t.m=null)}function li(t){if(!Nr(t.i)&&!t.m){t.m=!0;var e=t.Na;on||cn(),an||(on(),an=!0),hn.add(e,t),t.C=0}}function ui(t,e){var n;n=e?e.m:t.W++;const r=or(t.I);lr(r,"SID",t.K),lr(r,"RID",n),lr(r,"AID",t.V),di(t,r),t.o&&t.s&&ii(r,t.o,t.s),n=new jn(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=fi(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Or(t.i,n),Gn(n,r,e)}function di(t,e){t.na&&xe(t.na,(function(t,n){lr(e,n,t)})),t.h&&rr({},(function(t,n){lr(e,n,t)}))}function fi(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Yt(t.h.Va,t.h,t):null;t:{var i=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=e,0>n)e=Math.max(0,i[o].g-100),s=!1;else try{Vr(a,t,"req"+n+"_")}catch(t){r&&r(a)}}if(s){r=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,r}function pi(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;on||cn(),an||(on(),an=!0),hn.add(e,t),t.A=0}}function gi(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=kn(Yt(t.Ma,t),bi(t,t.A)),t.A++,0))}function mi(t){null!=t.B&&(qt.clearTimeout(t.B),t.B=null)}function yi(t){t.g=new jn(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=or(t.wa);lr(e,"RID","rpc"),lr(e,"SID",t.K),lr(e,"AID",t.V),lr(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&lr(e,"TO",t.qa),lr(e,"TYPE","xmlhttp"),di(t,e),t.o&&t.s&&ii(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=ur(or(e)),n.u=null,n.S=!0,Kn(n,t)}function vi(t){null!=t.v&&(qt.clearTimeout(t.v),t.v=null)}function wi(t,e){var n=null;if(t.g==e){vi(t),mi(t),t.g=null;var r=2}else{if(!xr(t.i,e))return;n=e.F,Rr(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;Je(r=Sn(),new Nn(r,n)),li(t)}else pi(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function(t,e){return!(kr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=kn(Yt(t.Na,t,e),bi(t,t.C)),t.C++,0)))}(t,e)||2==r&&gi(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ei(t,5);break;case 4:Ei(t,10);break;case 3:Ei(t,6);break;default:Ei(t,2)}}function bi(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ei(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=Yt(t.pb,t);n||(n=new sr("//www.google.com/images/cleardot.gif"),qt.location&&"http"==qt.location.protocol||ar(n,"https"),ur(n)),function(t,e){const n=new bn;if(qt.Image){const r=new Image;r.onload=Zt(Fr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Zt(Fr,n,r,"TestLoadImage: error",!1,e),r.onabort=Zt(Fr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Zt(Fr,n,r,"TestLoadImage: timeout",!1,e),qt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Dn(2);t.H=0,t.h&&t.h.za(e),Ti(t),ci(t)}function Ti(t){if(t.H=0,t.ma=[],t.h){const e=Lr(t.i);0==e.length&&0==t.j.length||(ie(t.ma,e),ie(t.ma,t.j),t.i.i.length=0,re(t.j),t.j.length=0),t.h.ya()}}function _i(t,e,n){var r=n instanceof sr?or(n):new sr(n);if(""!=r.g)e&&(r.g=e+"."+r.g),hr(r,r.m);else{var i=qt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new sr(null);r&&ar(s,r),e&&(s.g=e),i&&hr(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&lr(r,n,e),lr(r,"VER",t.ra),di(t,r),r}function Si(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Gr(new Ur({ob:n})):new Gr(t.va)).Oa(t.J),e}function Ii(){}function Ai(){if(ge&&!(10<=Number(Se)))throw Error("Environmental error: no available transport.")}function Ci(t,e){Xe.call(this),this.g=new oi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ae(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ae(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ki(this)}function Di(t){Fn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Ni(){Un.call(this),this.status=1}function ki(t){this.g=t}function xi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Oi(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function Ri(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(jt=Gr.prototype).Oa=function(t){this.M=t},jt.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Pn.g(),this.C=this.u?Ln(this.u):Ln(Pn),this.g.onreadystatechange=Yt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Xr(this,t)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=qt.FormData&&t instanceof qt.FormData,!(0<=ne(Wr,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ti(this),0<this.B&&((this.L=function(t){return ge&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Yt(this.ua,this)):this.A=fn(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Xr(this,t)}},jt.ua=function(){void 0!==Ht&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Je(this,"timeout"),this.abort(8))},jt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Je(this,"complete"),Je(this,"abort"),Zr(this))},jt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Zr(this,!0)),Gr.$.N.call(this)},jt.La=function(){this.s||(this.G||this.v||this.l?Yr(this):this.kb())},jt.kb=function(){Yr(this)},jt.isActive=function(){return!!this.g},jt.da=function(){try{return 2<ei(this)?this.g.status:-1}catch(t){return-1}},jt.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},jt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),qr(e)}},jt.Ia=function(){return this.m},jt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(jt=oi.prototype).ra=8,jt.H=1,jt.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new jn(this,this.l,t);let s=this.s;if(this.U&&(s?(s=Oe(s),Le(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=fi(this,i,e),lr(n=or(this.I),"RID",t),lr(n,"CVER",22),this.F&&lr(n,"X-HTTP-Session-Id",this.F),di(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(ri(s)))+"&"+e:this.o&&ii(n,this.o,s)),Or(this.i,i),this.bb&&lr(n,"TYPE","init"),this.P?(lr(n,"$req",e),lr(n,"SID","null"),i.aa=!0,Gn(i,n,null)):Gn(i,n,e),this.H=2}}else 3==this.H&&(t?ui(this,t):0==this.j.length||Nr(this.i)||ui(this))},jt.Ma=function(){if(this.u=null,yi(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=kn(Yt(this.jb,this),t)}},jt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dn(10),hi(this),yi(this))},jt.ib=function(){null!=this.v&&(this.v=null,hi(this),gi(this),Dn(19))},jt.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Dn(2)):(this.l.info("Failed to ping google.com"),Dn(1))},jt.isActive=function(){return!!this.h&&this.h.isActive(this)},(jt=Ii.prototype).Ba=function(){},jt.Aa=function(){},jt.za=function(){},jt.ya=function(){},jt.isActive=function(){return!0},jt.Va=function(){},Ai.prototype.g=function(t,e){return new Ci(t,e)},te(Ci,Xe),Ci.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Dn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=_i(t,null,t.Y),li(t)},Ci.prototype.close=function(){ai(this.g)},Ci.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Ze(t),t=n);e.j.push(new Ar(e.fb++,t)),3==e.H&&li(e)},Ci.prototype.N=function(){this.g.h=null,delete this.j,ai(this.g),delete this.g,Ci.$.N.call(this)},te(Di,Fn),te(Ni,Un),te(ki,Ii),ki.prototype.Ba=function(){Je(this.g,"a")},ki.prototype.Aa=function(t){Je(this.g,new Di(t))},ki.prototype.za=function(t){Je(this.g,new Ni)},ki.prototype.ya=function(){Je(this.g,"b")},te(xi,(function(){this.blockSize=-1})),xi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},xi.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)Oi(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Oi(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Oi(this,r),i=0;break}}this.h=i,this.i+=e},xi.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var Li={};function Mi(t){return-128<=t&&128>t?function(t,e){var n=Li;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new Ri([0|t],0>t?-1:0)}(t)}(t):new Ri([0|t],0>t?-1:0)}function Pi(t){if(isNaN(t)||!isFinite(t))return Fi;if(0>t)return zi(Pi(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Vi;return new Ri(e,0)}var Vi=4294967296,Fi=Mi(0),Ui=Mi(1),Bi=Mi(16777216);function ji(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function $i(t){return-1==t.h}function zi(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ri(n,~t.h).add(Ui)}function Hi(t,e){return t.add(zi(e))}function qi(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Gi(t,e){this.g=t,this.h=e}function Ki(t,e){if(ji(e))throw Error("division by zero");if(ji(t))return new Gi(Fi,Fi);if($i(t))return e=Ki(zi(t),e),new Gi(zi(e.g),zi(e.h));if($i(e))return e=Ki(t,zi(e)),new Gi(zi(e.g),e.h);if(30<t.g.length){if($i(t)||$i(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Ui,r=e;0>=r.X(t);)n=Qi(n),r=Qi(r);var i=Wi(n,1),s=Wi(r,1);for(r=Wi(r,2),n=Wi(n,2);!ji(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Wi(r,1),n=Wi(n,1)}return e=Hi(t,i.R(e)),new Gi(i,e)}for(i=Fi;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Pi(n)).R(e);$i(o)||0<o.X(t);)o=(s=Pi(n-=r)).R(e);ji(s)&&(s=Ui),i=i.add(s),t=Hi(t,o)}return new Gi(i,t)}function Qi(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ri(n,t.h)}function Wi(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ri(i,t.h)}(jt=Ri.prototype).ea=function(){if($i(this))return-zi(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Vi+r)*e,e*=Vi}return t},jt.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(ji(this))return"0";if($i(this))return"-"+zi(this).toString(t);for(var e=Pi(Math.pow(t,6)),n=this,r="";;){var i=Ki(n,e).g,s=((0<(n=Hi(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(ji(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},jt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},jt.X=function(t){return $i(t=Hi(this,t))?-1:ji(t)?0:1},jt.abs=function(){return $i(this)?zi(this):this},jt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ri(n,-2147483648&n[n.length-1]?-1:0)},jt.R=function(t){if(ji(this)||ji(t))return Fi;if($i(this))return $i(t)?zi(this).R(zi(t)):zi(zi(this).R(t));if($i(t))return zi(this.R(zi(t)));if(0>this.X(Bi)&&0>t.X(Bi))return Pi(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,h=65535&t.D(i);n[2*r+2*i]+=o*h,qi(n,2*r+2*i),n[2*r+2*i+1]+=s*h,qi(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,qi(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,qi(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ri(n,0)},jt.gb=function(t){return Ki(this,t).h},jt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ri(n,this.h&t.h)},jt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ri(n,this.h|t.h)},jt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ri(n,this.h^t.h)},Ai.prototype.createWebChannel=Ai.prototype.g,Ci.prototype.send=Ci.prototype.u,Ci.prototype.open=Ci.prototype.m,Ci.prototype.close=Ci.prototype.close,xn.NO_ERROR=0,xn.TIMEOUT=8,xn.HTTP_ERROR=6,On.COMPLETE="complete",Mn.EventType=Vn,Vn.OPEN="a",Vn.CLOSE="b",Vn.ERROR="c",Vn.MESSAGE="d",Xe.prototype.listen=Xe.prototype.O,Gr.prototype.listenOnce=Gr.prototype.P,Gr.prototype.getLastError=Gr.prototype.Sa,Gr.prototype.getLastErrorCode=Gr.prototype.Ia,Gr.prototype.getStatus=Gr.prototype.da,Gr.prototype.getResponseJson=Gr.prototype.Wa,Gr.prototype.getResponseText=Gr.prototype.ja,Gr.prototype.send=Gr.prototype.ha,Gr.prototype.setWithCredentials=Gr.prototype.Oa,xi.prototype.digest=xi.prototype.l,xi.prototype.reset=xi.prototype.reset,xi.prototype.update=xi.prototype.j,Ri.prototype.add=Ri.prototype.add,Ri.prototype.multiply=Ri.prototype.R,Ri.prototype.modulo=Ri.prototype.gb,Ri.prototype.compare=Ri.prototype.X,Ri.prototype.toNumber=Ri.prototype.ea,Ri.prototype.toString=Ri.prototype.toString,Ri.prototype.getBits=Ri.prototype.D,Ri.fromNumber=Pi,Ri.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return zi(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Pi(Math.pow(n,8)),i=Fi,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=Pi(Math.pow(n,o)),i=i.R(o).add(Pi(a))):i=(i=i.R(r)).add(Pi(a))}return i};var Xi=zt.createWebChannelTransport=function(){return new Ai},Ji=zt.getStatEventTarget=function(){return Sn()},Yi=zt.ErrorCode=xn,Zi=zt.EventType=On,ts=zt.Event=Tn,es=zt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ns=(zt.FetchXmlHttpFactory=Ur,zt.WebChannel=Mn),rs=zt.XhrIo=Gr,is=(zt.Md5=xi,zt.Integer=Ri);const ss="@firebase/firestore";class os{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}os.UNAUTHENTICATED=new os(null),os.GOOGLE_CREDENTIALS=new os("google-credentials-uid"),os.FIRST_PARTY=new os("first-party-uid"),os.MOCK_USER=new os("mock-user");let as="10.9.0";const hs=new D("@firebase/firestore");function cs(){return hs.logLevel}function ls(t,...e){if(hs.logLevel<=_.DEBUG){const n=e.map(fs);hs.debug(`Firestore (${as}): ${t}`,...n)}}function us(t,...e){if(hs.logLevel<=_.ERROR){const n=e.map(fs);hs.error(`Firestore (${as}): ${t}`,...n)}}function ds(t,...e){if(hs.logLevel<=_.WARN){const n=e.map(fs);hs.warn(`Firestore (${as}): ${t}`,...n)}}function fs(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function ps(t="Unexpected state"){const e=`FIRESTORE (${as}) INTERNAL ASSERTION FAILED: `+t;throw us(e),new Error(e)}function gs(t,e){t||ps()}function ms(t,e){return t}const ys={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vs extends d{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ws{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class bs{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Es{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(os.UNAUTHENTICATED)))}shutdown(){}}class Ts{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class _s{constructor(t){this.t=t,this.currentUser=os.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new ws;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ws,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{ls("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(ls("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ws)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(ls("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(gs("string"==typeof e.accessToken),new bs(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return gs(null===t||"string"==typeof t),new os(t)}}class Ss{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=os.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Is{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Ss(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(os.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class As{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cs{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&ls("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,ls("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const r=t=>{ls("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>r(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?r(t):ls("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(gs("string"==typeof t.token),this.R=t.token,new As(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Ds(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Ns{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=Ds(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function ks(t,e){return t<e?-1:t>e?1:0}function xs(t,e,n){return t.length===e.length&&t.every(((t,r)=>n(t,e[r])))}class Os{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new vs(ys.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new vs(ys.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new vs(ys.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new vs(ys.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Os.fromMillis(Date.now())}static fromDate(t){return Os.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Os(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ks(this.nanoseconds,t.nanoseconds):ks(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Rs{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Rs(t)}static min(){return new Rs(new Os(0,0))}static max(){return new Rs(new Os(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ls{constructor(t,e,n){void 0===e?e=0:e>t.length&&ps(),void 0===n?n=t.length-e:n>t.length-e&&ps(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Ls.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ls?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Ms extends Ls{construct(t,e,n){return new Ms(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new vs(ys.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Ms(e)}static emptyPath(){return new Ms([])}}const Ps=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vs extends Ls{construct(t,e,n){return new Vs(t,e,n)}static isValidIdentifier(t){return Ps.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vs.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Vs(["__name__"])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new vs(ys.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new vs(ys.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new vs(ys.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new vs(ys.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Vs(e)}static emptyPath(){return new Vs([])}}class Fs{constructor(t){this.path=t}static fromPath(t){return new Fs(Ms.fromString(t))}static fromName(t){return new Fs(Ms.fromString(t).popFirst(5))}static empty(){return new Fs(Ms.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Ms.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Ms.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Fs(new Ms(t.slice()))}}function Us(t){return new Bs(t.readTime,t.key,-1)}class Bs{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Bs(Rs.min(),Fs.empty(),-1)}static max(){return new Bs(Rs.max(),Fs.empty(),-1)}}function js(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Fs.comparator(t.documentKey,e.documentKey),0!==n?n:ks(t.largestBatchId,e.largestBatchId))}const $s="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Hs(t){if(t.code!==ys.FAILED_PRECONDITION||t.message!==$s)throw t;ls("LocalStore","Unexpectedly lost primary lease")}class qs{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ps(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new qs(((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof qs?e:qs.resolve(e)}catch(t){return qs.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):qs.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):qs.reject(e)}static resolve(t){return new qs(((e,n)=>{e(t)}))}static reject(t){return new qs(((e,n)=>{n(t)}))}static waitFor(t){return new qs(((e,n)=>{let r=0,i=0,s=!1;t.forEach((t=>{++r,t.next((()=>{++i,s&&i===r&&e()}),(t=>n(t)))})),s=!0,i===r&&e()}))}static or(t){let e=qs.resolve(!1);for(const n of t)e=e.next((t=>t?qs.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,r)=>{n.push(e.call(this,t,r))})),this.waitFor(n)}static mapArray(t,e){return new qs(((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const h=a;e(t[h]).next((t=>{s[h]=t,++o,o===i&&n(s)}),(t=>r(t)))}}))}static doWhile(t,e){return new qs(((n,r)=>{const i=()=>{!0===t()?e().next((()=>{i()}),r):n()};i()}))}}class Gs{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new ws,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Ws(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=to(e.target.error);this.V.reject(new Ws(t,n))}}static open(t,e,n,r){try{return new Gs(e,t.transaction(r,n))}catch(t){throw new Ws(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(ls("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Js(e)}}class Ks{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Ks.S(l())&&us("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return ls("SimpleDb","Removing database:",t),Ys(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!u())return!1;if(Ks.C())return!0;const t=l(),e=Ks.S(t),n=0<e&&e<10,r=Ks.v(t),i=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||i)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(ls("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=t=>{const n=t.target.result;e(n)},r.onblocked=()=>{n(new Ws(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=e=>{const r=e.target.error;"VersionError"===r.name?n(new vs(ys.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new vs(ys.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Ws(t,r))},r.onupgradeneeded=t=>{ls("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,r.transaction,t.oldVersion,this.version).next((()=>{ls("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db}B(t){this.L=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,r){const i="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=Gs.open(this.db,t,i?"readonly":"readwrite",n),s=r(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),qs.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(ls("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Qs{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Ys(this.k.delete())}}class Ws extends vs{constructor(t,e){super(ys.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Xs(t){return"IndexedDbTransactionError"===t.name}class Js{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(ls("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ls("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ys(n)}add(t){return ls("SimpleDb","ADD",this.store.name,t,t),Ys(this.store.add(t))}get(t){return Ys(this.store.get(t)).next((e=>(void 0===e&&(e=null),ls("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return ls("SimpleDb","DELETE",this.store.name,t),Ys(this.store.delete(t))}count(){return ls("SimpleDb","COUNT",this.store.name),Ys(this.store.count())}W(t,e){const n=this.options(t,e),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const t=r.getAll(n.range);return new qs(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new qs(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){ls("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const r=this.cursor(n);return this.G(r,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const r=this.cursor(n);return this.G(r,e)}Z(t){const e=this.cursor({});return new qs(((n,r)=>{e.onerror=t=>{const e=to(t.target.error);r(e)},e.onsuccess=e=>{const r=e.target.result;r?t(r.primaryKey,r.value).next((t=>{t?r.continue():n()})):n()}}))}G(t,e){const n=[];return new qs(((r,i)=>{t.onerror=t=>{i(t.target.error)},t.onsuccess=t=>{const i=t.target.result;if(!i)return void r();const s=new Qs(i),o=e(i.primaryKey,i.value,s);if(o instanceof qs){const t=o.catch((t=>(s.done(),qs.reject(t))));n.push(t)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>qs.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Ys(t){return new qs(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=to(t.target.error);n(e)}}))}let Zs=!1;function to(t){const e=Ks.S(l());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new vs("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Zs||(Zs=!0,setTimeout((()=>{throw t}),0)),t}}return t}class eo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function no(t){return null==t}function ro(t){return 0===t&&1/t==-1/0}eo._e=-1;function io(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function so(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function oo(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ao{constructor(t,e){this.comparator=t,this.root=e||co.EMPTY}insert(t,e){return new ao(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,co.BLACK,null,null))}remove(t){return new ao(this.comparator,this.root.remove(t,this.comparator).copy(null,null,co.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ho(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ho(this.root,t,this.comparator,!1)}getReverseIterator(){return new ho(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ho(this.root,t,this.comparator,!0)}}class ho{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class co{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:co.RED,this.left=null!=r?r:co.EMPTY,this.right=null!=i?i:co.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new co(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return co.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return co.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,co.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,co.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ps();if(this.right.isRed())throw ps();const t=this.left.check();if(t!==this.right.check())throw ps();return t+(this.isRed()?0:1)}}co.EMPTY=null,co.RED=!0,co.BLACK=!1,co.EMPTY=new class{constructor(){this.size=0}get key(){throw ps()}get value(){throw ps()}get color(){throw ps()}get left(){throw ps()}get right(){throw ps()}copy(t,e,n,r,i){return this}insert(t,e,n){return new co(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class lo{constructor(t){this.comparator=t,this.data=new ao(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new uo(this.data.getIterator())}getIteratorFrom(t){return new uo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof lo))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new lo(this.comparator);return e.data=t,e}}class uo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class fo{constructor(t){this.fields=t,t.sort(Vs.comparator)}static empty(){return new fo([])}unionWith(t){let e=new lo(Vs.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new fo(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return xs(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class po extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class go{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new po("Invalid base64 string: "+t):t}}(t);return new go(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new go(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ks(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}go.EMPTY_BYTE_STRING=new go("");const mo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){if(gs(!!t),"string"==typeof t){let e=0;const n=mo.exec(t);if(gs(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vo(t.seconds),nanos:vo(t.nanos)}}function vo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function wo(t){return"string"==typeof t?go.fromBase64String(t):go.fromUint8Array(t)}function bo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Eo(t){const e=t.mapValue.fields.__previous_value__;return bo(e)?Eo(e):e}function To(t){const e=yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Os(e.seconds,e.nanos)}class _o{constructor(t,e,n,r,i,s,o,a,h){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=h}}class So{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new So("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof So&&t.projectId===this.projectId&&t.database===this.database}}const Io={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bo(t)?4:Vo(t)?9007199254740991:10:ps()}function Co(t,e){if(t===e)return!0;const n=Ao(t);if(n!==Ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return To(t).isEqual(To(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=yo(t.timestampValue),r=yo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return wo(t.bytesValue).isEqual(wo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return vo(t.geoPointValue.latitude)===vo(e.geoPointValue.latitude)&&vo(t.geoPointValue.longitude)===vo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vo(t.integerValue)===vo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=vo(t.doubleValue),r=vo(e.doubleValue);return n===r?ro(n)===ro(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return xs(t.arrayValue.values||[],e.arrayValue.values||[],Co);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(io(n)!==io(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!Co(n[t],r[t])))return!1;return!0}(t,e);default:return ps()}}function Do(t,e){return void 0!==(t.values||[]).find((t=>Co(t,e)))}function No(t,e){if(t===e)return 0;const n=Ao(t),r=Ao(e);if(n!==r)return ks(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ks(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=vo(t.integerValue||t.doubleValue),r=vo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ko(t.timestampValue,e.timestampValue);case 4:return ko(To(t),To(e));case 5:return ks(t.stringValue,e.stringValue);case 6:return function(t,e){const n=wo(t),r=wo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=ks(n[t],r[t]);if(0!==e)return e}return ks(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=ks(vo(t.latitude),vo(e.latitude));return 0!==n?n:ks(vo(t.longitude),vo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=No(n[t],r[t]);if(e)return e}return ks(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Io.mapValue&&e===Io.mapValue)return 0;if(t===Io.mapValue)return 1;if(e===Io.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=ks(r[t],s[t]);if(0!==e)return e;const o=No(n[r[t]],i[s[t]]);if(0!==o)return o}return ks(r.length,s.length)}(t.mapValue,e.mapValue);default:throw ps()}}function ko(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ks(t,e);const n=yo(t),r=yo(e),i=ks(n.seconds,r.seconds);return 0!==i?i:ks(n.nanos,r.nanos)}function xo(t){return Oo(t)}function Oo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=yo(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return wo(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Fs.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=Oo(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+=`${i}:${Oo(t.fields[i])}`;return n+"}"}(t.mapValue):ps()}function Ro(t){return!!t&&"integerValue"in t}function Lo(t){return!!t&&"arrayValue"in t}function Mo(t){return!!t&&"mapValue"in t}function Po(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return so(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Po(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Po(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Vo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Fo{constructor(t){this.value=t}static empty(){return new Fo({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Mo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Po(e)}setAll(t){let e=Vs.emptyPath(),n={},r=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=Po(t):r.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());Mo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Co(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];Mo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){so(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Fo(Po(this.value))}}function Uo(t){const e=[];return so(t.fields,((t,n)=>{const r=new Vs([t]);if(Mo(n)){const t=Uo(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)})),new fo(e)}class Bo{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Bo(t,0,Rs.min(),Rs.min(),Rs.min(),Fo.empty(),0)}static newFoundDocument(t,e,n,r){return new Bo(t,1,e,Rs.min(),n,r,0)}static newNoDocument(t,e){return new Bo(t,2,e,Rs.min(),Rs.min(),Fo.empty(),0)}static newUnknownDocument(t,e){return new Bo(t,3,e,Rs.min(),Rs.min(),Fo.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Rs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Fo.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Fo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rs.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Bo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Bo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class jo{constructor(t,e){this.position=t,this.inclusive=e}}function $o(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?Fs.comparator(Fs.fromName(o.referenceValue),n.key):No(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function zo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Co(t.position[n],e.position[n]))return!1;return!0}class Ho{constructor(t,e="asc"){this.field=t,this.dir=e}}function qo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Go{}class Ko extends Go{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new ta(t,e,n):"array-contains"===e?new ia(t,n):"in"===e?new sa(t,n):"not-in"===e?new oa(t,n):"array-contains-any"===e?new aa(t,n):new Ko(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new ea(t,n):new na(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(No(e,this.value)):null!==e&&Ao(this.value)===Ao(e)&&this.matchesComparison(No(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ps()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qo extends Go{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Qo(t,e)}matches(t){return Wo(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Wo(t){return"and"===t.op}function Xo(t){return function(t){for(const e of t.filters)if(e instanceof Qo)return!1;return!0}(t)&&Wo(t)}function Jo(t){if(t instanceof Ko)return t.field.canonicalString()+t.op.toString()+xo(t.value);if(Xo(t))return t.filters.map((t=>Jo(t))).join(",");{const e=t.filters.map((t=>Jo(t))).join(",");return`${t.op}(${e})`}}function Yo(t,e){return t instanceof Ko?function(t,e){return e instanceof Ko&&t.op===e.op&&t.field.isEqual(e.field)&&Co(t.value,e.value)}(t,e):t instanceof Qo?function(t,e){return e instanceof Qo&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,r)=>t&&Yo(n,e.filters[r])),!0)}(t,e):void ps()}function Zo(t){return t instanceof Ko?function(t){return`${t.field.canonicalString()} ${t.op} ${xo(t.value)}`}(t):t instanceof Qo?function(t){return t.op.toString()+" {"+t.getFilters().map(Zo).join(" ,")+"}"}(t):"Filter"}class ta extends Ko{constructor(t,e,n){super(t,e,n),this.key=Fs.fromName(n.referenceValue)}matches(t){const e=Fs.comparator(t.key,this.key);return this.matchesComparison(e)}}class ea extends Ko{constructor(t,e){super(t,"in",e),this.keys=ra(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class na extends Ko{constructor(t,e){super(t,"not-in",e),this.keys=ra(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function ra(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Fs.fromName(t.referenceValue)))}class ia extends Ko{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Lo(e)&&Do(e.arrayValue,this.value)}}class sa extends Ko{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Do(this.value.arrayValue,e)}}class oa extends Ko{constructor(t,e){super(t,"not-in",e)}matches(t){if(Do(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Do(this.value.arrayValue,e)}}class aa extends Ko{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Lo(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Do(this.value.arrayValue,t)))}}class ha{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function ca(t,e=null,n=[],r=[],i=null,s=null,o=null){return new ha(t,e,n,r,i,s,o)}function la(t){const e=ms(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Jo(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),no(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>xo(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>xo(t))).join(",")),e.ce=t}return e.ce}function ua(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!qo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Yo(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zo(t.startAt,e.startAt)&&zo(t.endAt,e.endAt)}class da{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function fa(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function pa(t){const e=ms(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new lo(Vs.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);r.forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.le.push(new Ho(r,n))})),t.has(Vs.keyField().canonicalString())||e.le.push(new Ho(Vs.keyField(),n))}return e.le}function ga(t){const e=ms(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return ca(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Ho(t.field,e)}));const n=t.endAt?new jo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new jo(t.startAt.position,t.startAt.inclusive):null;return ca(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,pa(t))),e.he}function ma(t,e,n){return new da(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ya(t,e){return ua(ga(t),ga(e))&&t.limitType===e.limitType}function va(t){return`${la(ga(t))}|lt:${t.limitType}`}function wa(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Zo(t))).join(", ")}]`),no(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>xo(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>xo(t))).join(",")),`Target(${e})`}(ga(t))}; limitType=${t.limitType})`}function ba(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Fs.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of pa(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=$o(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,pa(t),e)||t.endAt&&!function(t,e,n){const r=$o(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,pa(t),e))}(t,e)}function Ea(t,e,n){const r=t.field.isKeyField()?Fs.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?No(r,i):ps()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ps()}}class Ta{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,r]of n)if(this.equalsFn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){so(this.inner,((e,n)=>{for(const[e,r]of n)t(e,r)}))}isEmpty(){return oo(this.inner)}size(){return this.innerSize}}const _a=new ao(Fs.comparator);function Sa(){return _a}const Ia=new ao(Fs.comparator);function Aa(...t){let e=Ia;for(const n of t)e=e.insert(n.key,n);return e}function Ca(t){let e=Ia;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Da(){return ka()}function Na(){return ka()}function ka(){return new Ta((t=>t.toString()),((t,e)=>t.isEqual(e)))}const xa=new ao(Fs.comparator),Oa=new lo(Fs.comparator);function Ra(...t){let e=Oa;for(const n of t)e=e.add(n);return e}const La=new lo(ks);function Ma(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ro(e)?"-0":e}}function Pa(t){return{integerValue:""+t}}function Va(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ro(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Pa(e):Ma(t,e)}class Fa{constructor(){this._=void 0}}function Ua(t,e,n){return t instanceof $a?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&bo(e)&&(e=Eo(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof za?Ha(t,e):t instanceof qa?Ga(t,e):function(t,e){const n=ja(t,e),r=Qa(n)+Qa(t.Ie);return Ro(n)&&Ro(t.Ie)?Pa(r):Ma(t.serializer,r)}(t,e)}function Ba(t,e,n){return t instanceof za?Ha(t,e):t instanceof qa?Ga(t,e):n}function ja(t,e){return t instanceof Ka?function(t){return Ro(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class $a extends Fa{}class za extends Fa{constructor(t){super(),this.elements=t}}function Ha(t,e){const n=Wa(e);for(const e of t.elements)n.some((t=>Co(t,e)))||n.push(e);return{arrayValue:{values:n}}}class qa extends Fa{constructor(t){super(),this.elements=t}}function Ga(t,e){let n=Wa(e);for(const e of t.elements)n=n.filter((t=>!Co(t,e)));return{arrayValue:{values:n}}}class Ka extends Fa{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Qa(t){return vo(t.integerValue||t.doubleValue)}function Wa(t){return Lo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Xa{constructor(t,e){this.version=t,this.transformResults=e}}class Ja{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ja}static exists(t){return new Ja(void 0,t)}static updateTime(t){return new Ja(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Ya(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Za{}function th(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new lh(t.key,Ja.none()):new sh(t.key,t.data,Ja.none());{const n=t.data,r=Fo.empty();let i=new lo(Vs.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new oh(t.key,r,new fo(i.toArray()),Ja.none())}}function eh(t,e,n){t instanceof sh?function(t,e,n){const r=t.value.clone(),i=hh(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof oh?function(t,e,n){if(!Ya(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=hh(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(ah(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function nh(t,e,n,r){return t instanceof sh?function(t,e,n,r){if(!Ya(t.precondition,e))return n;const i=t.value.clone(),s=ch(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof oh?function(t,e,n,r){if(!Ya(t.precondition,e))return n;const i=ch(t.fieldTransforms,r,e),s=e.data;return s.setAll(ah(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,r):function(t,e,n){return Ya(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function rh(t,e){let n=null;for(const r of t.fieldTransforms){const t=e.data.field(r.field),i=ja(r.transform,t||null);null!=i&&(null===n&&(n=Fo.empty()),n.set(r.field,i))}return n||null}function ih(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&xs(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof za&&e instanceof za||t instanceof qa&&e instanceof qa?xs(t.elements,e.elements,Co):t instanceof Ka&&e instanceof Ka?Co(t.Ie,e.Ie):t instanceof $a&&e instanceof $a}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sh extends Za{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class oh extends Za{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ah(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function hh(t,e,n){const r=new Map;gs(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Ba(o,a,n[i]))}return r}function ch(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,Ua(t,s,e))}return r}class lh extends Za{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uh extends Za{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dh{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const r=this.mutations[e];r.key.isEqual(t.key)&&eh(r,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=nh(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=nh(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Na();return this.mutations.forEach((r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=th(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Rs.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ra())}isEqual(t){return this.batchId===t.batchId&&xs(this.mutations,t.mutations,((t,e)=>ih(t,e)))&&xs(this.baseMutations,t.baseMutations,((t,e)=>ih(t,e)))}}class fh{constructor(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}static from(t,e,n){gs(t.mutations.length===n.length);let r=xa;const i=t.mutations;for(let t=0;t<i.length;t++)r=r.insert(i[t].key,n[t].version);return new fh(t,e,n,r)}}class ph{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var gh,mh;(mh=gh||(gh={}))[mh.OK=0]="OK",mh[mh.CANCELLED=1]="CANCELLED",mh[mh.UNKNOWN=2]="UNKNOWN",mh[mh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mh[mh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mh[mh.NOT_FOUND=5]="NOT_FOUND",mh[mh.ALREADY_EXISTS=6]="ALREADY_EXISTS",mh[mh.PERMISSION_DENIED=7]="PERMISSION_DENIED",mh[mh.UNAUTHENTICATED=16]="UNAUTHENTICATED",mh[mh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mh[mh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mh[mh.ABORTED=10]="ABORTED",mh[mh.OUT_OF_RANGE=11]="OUT_OF_RANGE",mh[mh.UNIMPLEMENTED=12]="UNIMPLEMENTED",mh[mh.INTERNAL=13]="INTERNAL",mh[mh.UNAVAILABLE=14]="UNAVAILABLE",mh[mh.DATA_LOSS=15]="DATA_LOSS",new is([4294967295,4294967295],0),Error;class yh{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function vh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wh(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bh(t,e){return vh(t,e.toTimestamp())}function Eh(t){return gs(!!t),Rs.fromTimestamp(function(t){const e=yo(t);return new Os(e.seconds,e.nanos)}(t))}function Th(t,e){return _h(t,e).canonicalString()}function _h(t,e){const n=function(t){return new Ms(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Sh(t,e){return Th(t.databaseId,e.path)}function Ih(t){const e=function(t){const e=Ms.fromString(t);return gs(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?Ms.emptyPath():function(t){return gs(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function Ah(t,e,n){return{name:Sh(t,e),fields:n.value.mapValue.fields}}function Ch(t){let e=Ih(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){gs(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=Dh(t);return e instanceof Qo&&Xo(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new Ho(Nh(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,no(e)?null:e}(n.limit));let h=null;n.startAt&&(h=function(t){const e=!!t.before,n=t.values||[];return new jo(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new jo(n,e)}(n.endAt)),function(t,e,n,r,i,s,o,a){return new da(t,e,n,r,i,s,o,a)}(e,i,o,s,a,"F",h,c)}function Dh(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Nh(t.unaryFilter.field);return Ko.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Nh(t.unaryFilter.field);return Ko.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Nh(t.unaryFilter.field);return Ko.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Nh(t.unaryFilter.field);return Ko.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ps()}}(t):void 0!==t.fieldFilter?function(t){return Ko.create(Nh(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ps()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Qo.create(t.compositeFilter.filters.map((t=>Dh(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ps()}}(t.compositeFilter.op))}(t):ps()}function Nh(t){return Vs.fromServerFormat(t.fieldPath)}function kh(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class xh{constructor(t){this.ct=t}}function Oh(t){const e=Ch({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ma(e,e.limit,"L"):e}class Rh{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(vo(t.integerValue));else if("doubleValue"in t){const n=vo(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),ro(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(wo(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?Vo(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):ps()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),Fs.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}Rh.bt=new Rh;class Lh{constructor(){this._n=new Mh}addToCollectionParentIndex(t,e){return this._n.add(e),qs.resolve()}getCollectionParents(t,e){return qs.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return qs.resolve()}deleteFieldIndex(t,e){return qs.resolve()}deleteAllFieldIndexes(t){return qs.resolve()}createTargetIndexes(t,e){return qs.resolve()}getDocumentsMatchingTarget(t,e){return qs.resolve(null)}getIndexType(t,e){return qs.resolve(0)}getFieldIndexes(t,e){return qs.resolve([])}getNextCollectionGroupToUpdate(t){return qs.resolve(null)}getMinOffset(t,e){return qs.resolve(Bs.min())}getMinOffsetFromCollectionGroup(t,e){return qs.resolve(Bs.min())}updateCollectionGroup(t,e,n){return qs.resolve()}updateIndexEntries(t,e){return qs.resolve()}}class Mh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new lo(Ms.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new lo(Ms.comparator)).toArray()}}new Uint8Array(0);class Ph{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Ph(t,Ph.DEFAULT_COLLECTION_PERCENTILE,Ph.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Ph.DEFAULT_COLLECTION_PERCENTILE=10,Ph.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ph.DEFAULT=new Ph(41943040,Ph.DEFAULT_COLLECTION_PERCENTILE,Ph.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ph.DISABLED=new Ph(-1,0,0);class Vh{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Vh(0)}static Ln(){return new Vh(-1)}}class Fh{constructor(){this.changes=new Ta((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Bo.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?qs.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Uh{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Bh{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((r=>(n=r,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&nh(n.mutation,t,fo.empty(),Os.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,Ra()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=Ra()){const r=Da();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,n).next((t=>{let e=Aa();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Da();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Ra())))}populateOverlays(t,e,n){const r=[];return n.forEach((t=>{e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,r){let i=Sa();const s=ka(),o=ka();return e.forEach(((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof oh)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),nh(o.mutation,e,o.mutation.getFieldMask(),Os.now())):s.set(e.key,fo.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new Uh(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=ka();let r=new ao(((t,e)=>t-e)),i=Ra();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||fo.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||Ra()).add(t);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,h=r.value,c=Na();h.forEach((t=>{if(!i.has(t)){const r=th(e.get(t),n.get(t));null!==r&&c.set(t,r),i=i.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,c))}return qs.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return Fs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):qs.resolve(Da());let o=-1,a=i;return s.next((e=>qs.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?qs.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,Ra()))).next((t=>({batchId:o,changes:Ca(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Fs(e)).next((t=>{let e=Aa();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=Aa();return this.indexManager.getCollectionParents(t,i).next((o=>qs.forEach(o,(o=>{const a=function(t,e){return new da(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r)))).next((t=>{i.forEach(((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,Bo.newInvalidDocument(r)))}));let n=Aa();return t.forEach(((t,r)=>{const s=i.get(t);void 0!==s&&nh(s.mutation,r,fo.empty(),Os.now()),ba(e,r)&&(n=n.insert(t,r))})),n}))}}class jh{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return qs.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Eh(t.createTime)}}(e)),qs.resolve()}getNamedQuery(t,e){return qs.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:Oh(t.bundledQuery),readTime:Eh(t.readTime)}}(e)),qs.resolve()}}class $h{constructor(){this.overlays=new ao(Fs.comparator),this.hr=new Map}getOverlay(t,e){return qs.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Da();return qs.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,r)=>{this.ht(t,e,r)})),qs.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),qs.resolve()}getOverlaysForCollection(t,e,n){const r=Da(),i=e.length+1,s=new Fs(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return qs.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new ao(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=Da(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Da(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=r)););return qs.resolve(o)}ht(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new ph(e,n));let i=this.hr.get(e);void 0===i&&(i=Ra(),this.hr.set(e,i)),this.hr.set(e,i.add(n.key))}}class zh{constructor(){this.Pr=new lo(Hh.Ir),this.Tr=new lo(Hh.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new Hh(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new Hh(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new Fs(new Ms([])),n=new Hh(e,t),r=new Hh(e,t+1),i=[];return this.Tr.forEachInRange([n,r],(t=>{this.Ar(t),i.push(t.key)})),i}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new Fs(new Ms([])),n=new Hh(e,t),r=new Hh(e,t+1);let i=Ra();return this.Tr.forEachInRange([n,r],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new Hh(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Hh{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return Fs.comparator(t.key,e.key)||ks(t.pr,e.pr)}static Er(t,e){return ks(t.pr,e.pr)||Fs.comparator(t.key,e.key)}}class qh{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new lo(Hh.Ir)}checkEmpty(t){return qs.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new dh(i,e,n,r);this.mutationQueue.push(s);for(const e of r)this.wr=this.wr.add(new Hh(e.key,i)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return qs.resolve(s)}lookupMutationBatch(t,e){return qs.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.br(n),i=r<0?0:r;return qs.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return qs.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return qs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Hh(e,0),r=new Hh(e,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(t=>{const e=this.Sr(t.pr);i.push(e)})),qs.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new lo(ks);return e.forEach((t=>{const e=new Hh(t,0),r=new Hh(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,r],(t=>{n=n.add(t.pr)}))})),qs.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;Fs.isDocumentKey(i)||(i=i.child(""));const s=new Hh(new Fs(i),0);let o=new lo(ks);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.pr)),!0)}),s),qs.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){gs(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return qs.forEach(e.mutations,(r=>{const i=new Hh(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new Hh(e,0),r=this.wr.firstAfterOrEqual(n);return qs.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,qs.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Gh{constructor(t){this.vr=t,this.docs=new ao(Fs.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return qs.resolve(n?n.document.mutableCopy():Bo.newInvalidDocument(e))}getEntries(t,e){let n=Sa();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Bo.newInvalidDocument(t))})),qs.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=Sa();const s=e.path,o=new Fs(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||js(Us(o),n)<=0||(r.has(o.key)||ba(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return qs.resolve(i)}getAllFromCollectionGroup(t,e,n,r){ps()}Fr(t,e){return qs.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Kh(this)}getSize(t){return qs.resolve(this.size)}}class Kh extends Fh{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?e.push(this.ar.addEntry(t,r)):this.ar.removeEntry(n)})),qs.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Qh{constructor(t){this.persistence=t,this.Mr=new Ta((t=>la(t)),ua),this.lastRemoteSnapshotVersion=Rs.min(),this.highestTargetId=0,this.Or=0,this.Nr=new zh,this.targetCount=0,this.Lr=Vh.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),qs.resolve()}getLastRemoteSnapshotVersion(t){return qs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return qs.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Lr.next(),qs.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),qs.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Lr=new Vh(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,qs.resolve()}updateTargetData(t,e){return this.qn(e),qs.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,qs.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)})),qs.waitFor(i).next((()=>r))}getTargetCount(t){return qs.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return qs.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),qs.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((e=>{i.push(r.markPotentiallyOrphaned(t,e))})),qs.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),qs.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return qs.resolve(n)}containsKey(t,e){return qs.resolve(this.Nr.containsKey(e))}}class Wh{constructor(t,e){this.Br={},this.overlays={},this.kr=new eo(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Qh(this),this.indexManager=new Lh,this.remoteDocumentCache=function(t){return new Gh(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new xh(e),this.$r=new jh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new $h,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Br[t.toKey()];return n||(n=new qh(e,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){ls("MemoryPersistence","Starting transaction:",t);const r=new Xh(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((t=>this.referenceDelegate.Wr(r).next((()=>t)))).toPromise().then((t=>(r.raiseOnCommittedEvent(),t)))}Gr(t,e){return qs.or(Object.values(this.Br).map((n=>()=>n.containsKey(t,e))))}}class Xh extends zs{constructor(t){super(),this.currentSequenceNumber=t}}class Jh{constructor(t){this.persistence=t,this.zr=new zh,this.jr=null}static Hr(t){return new Jh(t)}get Jr(){if(this.jr)return this.jr;throw ps()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),qs.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),qs.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),qs.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qs.forEach(this.Jr,(n=>{const r=Fs.fromPath(n);return this.Yr(t,r).next((t=>{t||e.removeEntry(r,Rs.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return qs.or([()=>qs.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class Yh{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=r}static Ki(t,e){let n=Ra(),r=Ra();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new Yh(t,e.fromCache,n,r)}}class Zh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class tc{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var t;const e=null===(t=a())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Ks.v(l())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.ji(t,e).next((t=>{i.result=t})).next((()=>{if(!i.result)return this.Hi(t,e,r,n).next((t=>{i.result=t}))})).next((()=>{if(i.result)return;const n=new Zh;return this.Ji(t,e,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(t,e,n,r.size)}))})).next((()=>i.result))}Yi(t,e,n,r){return n.documentReadCount<this.Wi?(cs()<=_.DEBUG&&ls("QueryEngine","SDK will not create cache indexes for query:",wa(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),qs.resolve()):(cs()<=_.DEBUG&&ls("QueryEngine","Query:",wa(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(cs()<=_.DEBUG&&ls("QueryEngine","The SDK decides to create cache indexes for query:",wa(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ga(e))):qs.resolve())}ji(t,e){if(fa(e))return qs.resolve(null);let n=ga(e);return this.indexManager.getIndexType(t,n).next((r=>0===r?null:(null!==e.limit&&1===r&&(e=ma(e,null,"F"),n=ga(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((r=>{const i=Ra(...r);return this.zi.getDocuments(t,i).next((r=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,r);return this.Xi(e,s,i,n.readTime)?this.ji(t,ma(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,r){return fa(e)||r.isEqual(Rs.min())?qs.resolve(null):this.zi.getDocuments(t,n).next((i=>{const s=this.Zi(e,i);return this.Xi(e,s,n,r)?qs.resolve(null):(cs()<=_.DEBUG&&ls("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),wa(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Rs.fromTimestamp(1e9===r?new Os(n+1,0):new Os(n,r));return new Bs(i,Fs.empty(),e)}(r,-1)).next((t=>t)))}))}Zi(t,e){let n=new lo(function(t){return(e,n)=>{let r=!1;for(const i of pa(t)){const t=Ea(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}(t));return e.forEach(((e,r)=>{ba(t,r)&&(n=n.add(r))})),n}Xi(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(t,e,n){return cs()<=_.DEBUG&&ls("QueryEngine","Using full collection scan to execute query:",wa(e)),this.zi.getDocumentsMatchingQuery(t,e,Bs.min(),n)}es(t,e,n,r){return this.zi.getDocumentsMatchingQuery(t,n,r).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class ec{constructor(t,e,n,r){this.persistence=t,this.ts=e,this.serializer=r,this.ns=new ao(ks),this.rs=new Ta((t=>la(t)),ua),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Bh(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function nc(t,e){const n=ms(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next((i=>(r=i,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],s=[];let o=Ra();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:i,addedBatchIds:s})))}))}))}function rc(t,e){const n=ms(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class ic{constructor(){this.activeTargetIds=La}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class sc{constructor(){this.no=new ic,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new ic,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class oc{io(t){}shutdown(){}}class ac{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){ls("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){ls("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let hc=null;function cc(){return null===hc?hc=268435456+Math.round(2147483648*Math.random()):hc++,"0x"+hc.toString(16)}const lc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class uc{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const dc="WebChannelConnection";class fc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(t,e,n,r,i){const s=cc(),o=this.bo(t,e.toUriEncodedString());ls("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(t,o,a,n).then((e=>(ls("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw ds("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,r,i,s){return this.So(t,e,n,r,i)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+as,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=lc[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,r){const i=cc();return new Promise(((s,o)=>{const a=new rs;a.setWithCredentials(!0),a.listenOnce(Zi.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Yi.NO_ERROR:const e=a.getResponseJson();ls(dc,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(e)),s(e);break;case Yi.TIMEOUT:ls(dc,`RPC '${t}' ${i} timed out`),o(new vs(ys.DEADLINE_EXCEEDED,"Request time out"));break;case Yi.HTTP_ERROR:const n=a.getStatus();if(ls(dc,`RPC '${t}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(ys).indexOf(e)>=0?e:ys.UNKNOWN}(e.status);o(new vs(t,e.message))}else o(new vs(ys.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new vs(ys.UNAVAILABLE,"Connection failed."));break;default:ps()}}finally{ls(dc,`RPC '${t}' ${i} completed.`)}}));const h=JSON.stringify(r);ls(dc,`RPC '${t}' ${i} sending request:`,r),a.send(e,"POST",h,n,15)}))}Fo(t,e,n){const r=cc(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Xi(),o=Ji(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;void 0!==h&&(a.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const c=i.join("");ls(dc,`Creating RPC '${t}' stream ${r}: ${c}`,a);const l=s.createWebChannel(c,a);let u=!1,d=!1;const f=new uc({lo:e=>{d?ls(dc,`Not sending because RPC '${t}' stream ${r} is closed:`,e):(u||(ls(dc,`Opening RPC '${t}' stream ${r} transport.`),l.open(),u=!0),ls(dc,`RPC '${t}' stream ${r} sending:`,e),l.send(e))},ho:()=>l.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(l,ns.EventType.OPEN,(()=>{d||ls(dc,`RPC '${t}' stream ${r} transport opened.`)})),p(l,ns.EventType.CLOSE,(()=>{d||(d=!0,ls(dc,`RPC '${t}' stream ${r} transport closed`),f.Vo())})),p(l,ns.EventType.ERROR,(e=>{d||(d=!0,ds(dc,`RPC '${t}' stream ${r} transport errored:`,e),f.Vo(new vs(ys.UNAVAILABLE,"The operation could not be completed")))})),p(l,ns.EventType.MESSAGE,(e=>{var n;if(!d){const i=e.data[0];gs(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){ls(dc,`RPC '${t}' stream ${r} received error:`,o);const e=o.status;let n=function(t){const e=gh[t];if(void 0!==e)return function(t){if(void 0===t)return us("GRPC error has no .code"),ys.UNKNOWN;switch(t){case gh.OK:return ys.OK;case gh.CANCELLED:return ys.CANCELLED;case gh.UNKNOWN:return ys.UNKNOWN;case gh.DEADLINE_EXCEEDED:return ys.DEADLINE_EXCEEDED;case gh.RESOURCE_EXHAUSTED:return ys.RESOURCE_EXHAUSTED;case gh.INTERNAL:return ys.INTERNAL;case gh.UNAVAILABLE:return ys.UNAVAILABLE;case gh.UNAUTHENTICATED:return ys.UNAUTHENTICATED;case gh.INVALID_ARGUMENT:return ys.INVALID_ARGUMENT;case gh.NOT_FOUND:return ys.NOT_FOUND;case gh.ALREADY_EXISTS:return ys.ALREADY_EXISTS;case gh.PERMISSION_DENIED:return ys.PERMISSION_DENIED;case gh.FAILED_PRECONDITION:return ys.FAILED_PRECONDITION;case gh.ABORTED:return ys.ABORTED;case gh.OUT_OF_RANGE:return ys.OUT_OF_RANGE;case gh.UNIMPLEMENTED:return ys.UNIMPLEMENTED;case gh.DATA_LOSS:return ys.DATA_LOSS;default:return ps()}}(e)}(e),i=o.message;void 0===n&&(n=ys.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new vs(n,i)),l.close()}else ls(dc,`RPC '${t}' stream ${r} received:`,i),f.mo(i)}})),p(o,ts.STAT_EVENT,(e=>{e.stat===es.PROXY?ls(dc,`RPC '${t}' stream ${r} detected buffering proxy`):e.stat===es.NOPROXY&&ls(dc,`RPC '${t}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function pc(){return"undefined"!=typeof document?document:null}function gc(t){return new yh(t,!0)}class mc{constructor(t,e,n=1e3,r=1.5,i=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,e-n);r>0&&ls("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class yc{constructor(t,e,n,r,i,s,o,a){this.oi=t,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new mc(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===ys.RESOURCE_EXHAUSTED?(us(e.toString()),us("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===ys.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new vs(ys.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return ls("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(ls("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class vc extends yc{constructor(t,e,n,r,i,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(gs(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(gs(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Eh(t.updateTime):Eh(e);return n.isEqual(Rs.min())&&(n=Eh(e)),new Xa(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Eh(t.commitTime);return this.listener.T_(n,e)}return gs(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=function(t){return new Ms(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof sh)n={update:Ah(t,e.key,e.value)};else if(e instanceof lh)n={delete:Sh(t,e.key)};else if(e instanceof oh)n={update:Ah(t,e.key,e.data),updateMask:kh(e.fieldMask)};else{if(!(e instanceof uh))return ps();n={verify:Sh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof $a)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof za)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof qa)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ka)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw ps()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:bh(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ps()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class wc extends class{}{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new vs(ys.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.So(t,_h(e,n),r,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ys.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new vs(ys.UNKNOWN,t.toString())}))}vo(t,e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,_h(e,n),r,s,o,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ys.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new vs(ys.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class bc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(us(e),this.g_=!1):ls("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Ec{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((t=>{n.enqueueAndForget((async()=>{Sc(this)&&(ls("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=ms(t);e.v_.add(4),await _c(e),e.x_.set("Unknown"),e.v_.delete(4),await Tc(e)}(this))}))})),this.x_=new bc(n,r)}}async function Tc(t){if(Sc(t))for(const e of t.F_)await e(!0)}async function _c(t){for(const e of t.F_)await e(!1)}function Sc(t){return 0===ms(t).v_.size}async function Ic(t,e,n){if(!Xs(e))throw e;t.v_.add(1),await _c(t),t.x_.set("Offline"),n||(n=()=>function(t){const e=ms(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ls("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await Tc(t)}))}function Ac(t,e){return e().catch((n=>Ic(t,n,e)))}async function Cc(t){const e=ms(t),n=Vc(e);let r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Dc(e);)try{const t=await rc(e.localStore,r);if(null===t){0===e.D_.length&&n.Xo();break}r=t.batchId,Nc(e,t)}catch(t){await Ic(e,t)}kc(e)&&xc(e)}function Dc(t){return Sc(t)&&t.D_.length<10}function Nc(t,e){t.D_.push(e);const n=Vc(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function kc(t){return Sc(t)&&!Vc(t).Ho()&&t.D_.length>0}function xc(t){Vc(t).start()}async function Oc(t){Vc(t).d_()}async function Rc(t){const e=Vc(t);for(const n of t.D_)e.I_(n.mutations)}async function Lc(t,e,n){const r=t.D_.shift(),i=fh.from(r,e,n);await Ac(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await Cc(t)}async function Mc(t,e){e&&Vc(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return ps();case ys.CANCELLED:case ys.UNKNOWN:case ys.DEADLINE_EXCEEDED:case ys.RESOURCE_EXHAUSTED:case ys.INTERNAL:case ys.UNAVAILABLE:case ys.UNAUTHENTICATED:return!1;case ys.INVALID_ARGUMENT:case ys.NOT_FOUND:case ys.ALREADY_EXISTS:case ys.PERMISSION_DENIED:case ys.FAILED_PRECONDITION:case ys.ABORTED:case ys.OUT_OF_RANGE:case ys.UNIMPLEMENTED:case ys.DATA_LOSS:return!0}}(t)&&t!==ys.ABORTED}(e.code)){const n=t.D_.shift();Vc(t).Zo(),await Ac(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Cc(t)}}(t,e),kc(t)&&xc(t)}async function Pc(t,e){const n=ms(t);n.asyncQueue.verifyOperationInProgress(),ls("RemoteStore","RemoteStore received new credentials");const r=Sc(n);n.v_.add(3),await _c(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await Tc(n)}function Vc(t){return t.L_||(t.L_=function(t,e,n){const r=ms(t);return r.R_(),new vc(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Po:Oc.bind(null,t),To:Mc.bind(null,t),E_:Rc.bind(null,t),T_:Lc.bind(null,t)}),t.F_.push((async e=>{e?(t.L_.Zo(),await Cc(t)):(await t.L_.stop(),t.D_.length>0&&(ls("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}class Fc{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ws,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new Fc(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new vs(ys.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uc(t,e){if(us("AsyncQueue",`${e}: ${t}`),Xs(t))return new vs(ys.UNAVAILABLE,`${e}: ${t}`);throw t}class Bc{constructor(){this.queries=new Ta((t=>va(t)),ya),this.onlineState="Unknown",this.W_=new Set}}var jc,$c;($c=jc||(jc={})).j_="default",$c.Cache="cache";class zc{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.ya={},this.wa=new Ta((t=>va(t)),ya),this.Sa=new Map,this.ba=new Set,this.Da=new ao(Fs.comparator),this.Ca=new Map,this.va=new zh,this.Fa={},this.Ma=new Map,this.xa=Vh.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}function Hc(t,e,n){const r=ms(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.wa.forEach(((n,r)=>{const i=r.view.G_(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=ms(t);n.onlineState=e;let r=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.G_(e)&&(r=!0)})),r&&function(t){t.W_.forEach((t=>{t.next()}))}(n)}(r.eventManager,e),t.length&&r.ya.u_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function qc(t,e){const n=ms(t),r=e.batch.batchId;try{const t=await function(t,e){const n=ms(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const r=e.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){const i=n.batch,s=i.keys();let o=qs.resolve();return s.forEach((t=>{o=o.next((()=>r.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);gs(null!==s),e.version.compareTo(s)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Ra();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(n.localStore,e);Qc(n,r,null),Kc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Wc(n,t)}catch(t){await Hs(t)}}async function Gc(t,e,n){const r=ms(t);try{const t=await function(t,e){const n=ms(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let r;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(gs(null!==e),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(r.localStore,e);Qc(r,e,n),Kc(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Wc(r,t)}catch(n){await Hs(n)}}function Kc(t,e){(t.Ma.get(e)||[]).forEach((t=>{t.resolve()})),t.Ma.delete(e)}function Qc(t,e,n){const r=ms(t);let i=r.Fa[r.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}async function Wc(t,e,n){const r=ms(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach(((t,a)=>{o.push(r.Na(a,e,n).then((t=>{if((t||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=Yh.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),r.ya.u_(i),await async function(t,e){const n=ms(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>qs.forEach(e,(e=>qs.forEach(e.qi,(r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r))).next((()=>qs.forEach(e.Qi,(r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))))))}catch(t){if(!Xs(t))throw t;ls("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,i)}}}(r.localStore,s))}async function Xc(t,e){const n=ms(t);if(!n.currentUser.isEqual(e)){ls("SyncEngine","User change. New user:",e.toKey());const t=await nc(n.localStore,e);n.currentUser=e,function(t,e){t.Ma.forEach((t=>{t.forEach((t=>{t.reject(new vs(ys.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ma.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Wc(n,t.us)}}function Jc(t){const e=ms(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qc.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Gc.bind(null,e),e}class Yc{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=gc(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,r){return new ec(t,e,n,r)}(this.persistence,new tc,t.initialUser,this.serializer)}createPersistence(t){return new Wh(Jh.Hr,this.serializer)}createSharedClientState(t){return new sc}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Zc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Hc(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xc.bind(null,this.syncEngine),await async function(t,e){const n=ms(t);e?(n.v_.delete(2),await Tc(n)):e||(n.v_.add(2),await _c(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Bc}createDatastore(t){const e=gc(t.databaseInfo.databaseId),n=function(t){return new fc(t)}(t.databaseInfo);return function(t,e,n,r){return new wc(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new Ec(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,(t=>Hc(this.syncEngine,t,0)),ac.D()?new ac:new oc)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new zc(t,e,n,r,i,s);return o&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=ms(t);ls("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await _c(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class tl{constructor(t,e,n,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=os.UNAUTHENTICATED,this.clientId=Ns.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{ls("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(ls("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new vs(ys.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ws;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Uc(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function el(t,e){t.asyncQueue.verifyOperationInProgress(),ls("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async t=>{r.isEqual(t)||(await nc(e.localStore,t),r=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function nl(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ls("FirestoreClient","Using user provided OfflineComponentProvider");try{await el(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===ys.FAILED_PRECONDITION||t.code===ys.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;ds("Error using user provided cache. Falling back to memory cache: "+n),await el(t,new Yc)}}else ls("FirestoreClient","Using default OfflineComponentProvider"),await el(t,new Yc);return t._offlineComponents}(t);ls("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Pc(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Pc(e.remoteStore,n))),t._onlineComponents=e}function rl(t){return async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ls("FirestoreClient","Using user provided OnlineComponentProvider"),await nl(t,t._uninitializedComponentsProvider._online)):(ls("FirestoreClient","Using default OnlineComponentProvider"),await nl(t,new Zc))),t._onlineComponents}(t).then((t=>t.syncEngine))}function il(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const sl=new Map;function ol(t,e,n){if(!n)throw new vs(ys.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function al(t){if(!Fs.isDocumentKey(t))throw new vs(ys.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hl(t){if(Fs.isDocumentKey(t))throw new vs(ys.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function cl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":ps()}function ll(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new vs(ys.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cl(t);throw new vs(ys.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class ul{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new vs(ys.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new vs(ys.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new vs(ys.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=il(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new vs(ys.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new vs(ys.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new vs(ys.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class dl{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ul({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new vs(ys.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new vs(ys.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ul(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Es;switch(t.type){case"firstParty":return new Is(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new vs(ys.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=sl.get(t);e&&(ls("ComponentProvider","Removing Datastore"),sl.delete(t),e.terminate())}(this),Promise.resolve()}}class fl{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new fl(this.firestore,t,this._query)}}class pl{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gl(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new pl(this.firestore,t,this._key)}}class gl extends fl{constructor(t,e,n){super(t,e,function(t){return new da(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new pl(this.firestore,null,new Fs(t))}withConverter(t){return new gl(this.firestore,t,this._path)}}class ml{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new mc(this,"async_queue_retry"),this.cu=()=>{const t=pc();t&&ls("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=pc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.lu(),this.hu(t)}enterRestrictedMode(t){if(!this.iu){this.iu=!0,this.au=t||!1;const e=pc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.cu)}}enqueue(t){if(this.lu(),this.iu)return new Promise((()=>{}));const e=new ws;return this.hu((()=>this.iu&&this.au?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.ru.push(t),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(t){if(!Xs(t))throw t;ls("AsyncQueue","Operation failed with retryable error: "+t)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(t){const e=this.nu.then((()=>(this._u=!0,t().catch((t=>{this.ou=t,this._u=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw us("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this._u=!1,t))))));return this.nu=e,e}enqueueAfterDelay(t,e,n){this.lu(),this.uu.indexOf(t)>-1&&(e=0);const r=Fc.createAndSchedule(this,t,e,n,(t=>this.Iu(t)));return this.su.push(r),r}lu(){this.ou&&ps()}verifyOperationInProgress(){}async Tu(){let t;do{t=this.nu,await t}while(t!==this.nu)}Eu(t){for(const e of this.su)if(e.timerId===t)return!0;return!1}du(t){return this.Tu().then((()=>{this.su.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.su)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Tu()}))}Au(t){this.uu.push(t)}Iu(t){const e=this.su.indexOf(t);this.su.splice(e,1)}}class yl extends dl{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new ml,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||vl(this),this._firestoreClient.terminate()}}function vl(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new _o(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,il(r.experimentalLongPollingOptions),r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new tl(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class wl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new wl(go.fromBase64String(t))}catch(t){throw new vs(ys.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new wl(go.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class bl{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new vs(ys.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class El{constructor(t){this._methodName=t}}class Tl{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new vs(ys.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new vs(ys.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ks(this._lat,t._lat)||ks(this._long,t._long)}}const _l=/^__.*__$/;class Sl{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new oh(t,this.data,this.fieldMask,e,this.fieldTransforms):new sh(t,this.data,e,this.fieldTransforms)}}function Il(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ps()}}class Al{constructor(t,e,n,r,i,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ru(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(t){return new Al(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mu({path:n,gu:!1});return r.pu(t),r}yu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mu({path:n,gu:!1});return r.Ru(),r}wu(t){return this.mu({path:void 0,gu:!0})}Su(t){return Pl(t,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Ru(){if(this.path)for(let t=0;t<this.path.length;t++)this.pu(this.path.get(t))}pu(t){if(0===t.length)throw this.Su("Document fields must not be empty");if(Il(this.Vu)&&_l.test(t))throw this.Su('Document fields cannot begin and end with "__"')}}class Cl{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||gc(t)}Cu(t,e,n,r=!1){return new Al({Vu:t,methodName:e,Du:n,path:Vs.emptyPath(),gu:!1,bu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dl(t){const e=t._freezeSettings(),n=gc(t._databaseId);return new Cl(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nl(t,e,n,r,i,s={}){const o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);Rl("Data must be an object, but it was:",o,r);const a=xl(r,o);let h,c;if(s.merge)h=new fo(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=Ll(e,r,n);if(!o.contains(i))throw new vs(ys.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Vl(t,i)||t.push(i)}h=new fo(t),c=o.fieldTransforms.filter((t=>h.covers(t.field)))}else h=null,c=o.fieldTransforms;return new Sl(new Fo(a),h,c)}function kl(t,e){if(Ol(t=y(t)))return Rl("Unsupported field value:",e,t),xl(t,e);if(t instanceof El)return function(t,e){if(!Il(e.Vu))throw e.Su(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Su(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&4!==e.Vu)throw e.Su("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=kl(i,e.wu(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=y(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Va(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Os.fromDate(t);return{timestampValue:vh(e.serializer,n)}}if(t instanceof Os){const n=new Os(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:vh(e.serializer,n)}}if(t instanceof Tl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wl)return{bytesValue:wh(e.serializer,t._byteString)};if(t instanceof pl){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Su(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Th(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Su(`Unsupported field value: ${cl(t)}`)}(t,e)}function xl(t,e){const n={};return oo(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):so(t,((t,r)=>{const i=kl(r,e.fu(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ol(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Os||t instanceof Tl||t instanceof wl||t instanceof pl||t instanceof El)}function Rl(t,e,n){if(!Ol(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=cl(n);throw"an object"===r?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function Ll(t,e,n){if((e=y(e))instanceof bl)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(Ml)>=0)throw Pl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new bl(...e.split("."))._internalPath}catch(r){throw Pl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw Pl("Field path arguments must be of type string or ",t,!1,void 0,n)}const Ml=new RegExp("[~\\*/\\[\\]]");function Pl(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let h="";return(s||o)&&(h+=" (found",s&&(h+=` in field ${r}`),o&&(h+=` in document ${i}`),h+=")"),new vs(ys.INVALID_ARGUMENT,a+t+h)}function Vl(t,e){return t.some((t=>t.isEqual(e)))}function Fl(t,e){const n=ll(t.firestore,yl),r=function(t,e,...n){if(t=y(t),1===arguments.length&&(e=Ns.newId()),ol("doc","path",e),t instanceof dl){const r=Ms.fromString(e,...n);return al(r),new pl(t,null,new Fs(r))}{if(!(t instanceof pl||t instanceof gl))throw new vs(ys.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ms.fromString(e,...n));return al(r),new pl(t.firestore,t instanceof gl?t.converter:null,new Fs(r))}}(t),i=function(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}(t.converter,e);return function(t,e){return function(t,e){const n=new ws;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const r=Jc(t);try{const t=await function(t,e){const n=ms(t),r=Os.now(),i=e.reduce(((t,e)=>t.add(e.key)),Ra());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Sa(),h=Ra();return n.os.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(h=h.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{s=i;const o=[];for(const t of e){const e=rh(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new oh(t.key,e,Uo(e.value.mapValue),Ja.exists(!0)))}return n.mutationQueue.addMutationBatch(t,r,o,e)})).next((e=>{o=e;const r=e.applyToLocalDocumentSet(s,h);return n.documentOverlayCache.saveOverlays(t,e.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Ca(s)})))}(r.localStore,e);r.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let r=t.Fa[t.currentUser.toKey()];r||(r=new ao(ks)),r=r.insert(e,n),t.Fa[t.currentUser.toKey()]=r}(r,t.batchId,n),await Wc(r,t.changes),await Cc(r.remoteStore)}catch(t){const e=Uc(t,"Failed to persist write");n.reject(e)}}(await rl(t),e,n))),n.promise}(function(t){return t._firestoreClient||vl(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[Nl(Dl(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ja.exists(!1))]).then((()=>r))}new WeakMap,function(t,e=!0){as="10.9.0",It(new v("firestore",((t,{instanceIdentifier:n,options:r})=>{const i=t.getProvider("app").getImmediate(),s=new yl(new _s(t.getProvider("auth-internal")),new Cs(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new vs(ys.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new So(t.options.projectId,e)}(i,n),i);return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),Nt(ss,"4.5.0",t),Nt(ss,"4.5.0","esm2017")}();const Ul=function(t,e){const n="string"==typeof t?t:"(default)",r=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}("object"==typeof t?t:function(t=bt){const e=Tt.get(t);if(!e&&t===bt&&h())return Dt();if(!e)throw At.create("no-app",{appName:t});return e}(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=a())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]})("firestore");t&&function(t,e,n,r={}){var i;const s=(t=ll(t,dl))._getSettings(),a=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&ds("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=os.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new vs(ys.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new os(s)}t._authCredentials=new Ts(new bs(e,n))}}(r,...t)}return r}(Dt({apiKey:"AIzaSyA-_mnUQ4kNNi61f71pe2gDONwYaqqzDKA",authDomain:"lab6-prueba.firebaseapp.com",projectId:"lab6-prueba",storageBucket:"lab6-prueba.appspot.com",messagingSenderId:"794296916530",appId:"1:794296916530:web:3ca7713fdbd351e267ba2b"}));var Bl=n(9);const jl={name:"",color:"",letra:""};class $l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),e=[...e,this]}connectedCallback(){this.render()}async render(){console.log("hola");const n=this.ownerDocument.createElement("h1");n.innerText="Crea una publicacin",this.shadowRoot?.appendChild(n);const r=this.ownerDocument.createElement("input");r.type="text",r.placeholder="Nombre",r.addEventListener("change",this.addNombre),this.shadowRoot?.appendChild(r);const i=this.ownerDocument.createElement("input");i.type="color",i.addEventListener("change",this.addColor),this.shadowRoot?.appendChild(i);const s=this.ownerDocument.createElement("input");s.placeholder="Letra",s.addEventListener("change",this.addLetra),this.shadowRoot?.appendChild(s);const o=this.ownerDocument.createElement("button");o.innerHTML="Guardar publicacion",o.addEventListener("click",this.submitForm),this.shadowRoot?.appendChild(o);const a=this.ownerDocument.createElement("button");a.innerHTML="Ve a ver las publicaciones creadas!",a.addEventListener("click",(()=>{(n=>{const r=JSON.parse(JSON.stringify(t));t=((t,e)=>{const{action:n,payload:r}=t;return"changeScreen"===n&&(e.screen=r),e})({action:"changeScreen",payload:"PUBLISHED"},r),e.forEach((t=>t.render()))})()}));const h=this.ownerDocument.createElement("style");h.innerHTML=Bl.A,this.shadowRoot?.appendChild(h)}addNombre(t){jl.name=t.target?.value}addColor(t){jl.color=t.target?.value}addLetra(t){jl.letra=t.target?.value}submitForm(){(async t=>{try{const e=await Fl(function(t,e,...n){if(t=y(t),ol("collection","path",e),t instanceof dl){const r=Ms.fromString(e,...n);return hl(r),new gl(t,null,r)}{if(!(t instanceof pl||t instanceof gl))throw new vs(ys.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ms.fromString(e,...n));return hl(r),new gl(t.firestore,null,r)}}(Ul,"users"),t);console.log("Document written with ID: ",e.id)}catch(t){console.error("Error adding document: ",t)}})(jl)}}customElements.define("app-dashboard",$l);class zl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot&&(this.shadowRoot.innerHTML=""),"DASHBOARD"===t.screen){const t=this.ownerDocument.createElement("app-dashboard");this.shadowRoot?.appendChild(t)}}}customElements.define("app-container",zl)})()})();
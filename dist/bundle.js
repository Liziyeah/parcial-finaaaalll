/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={523:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,"/* stylesAbuelo.css */\n\n:host {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tfont-family: Arial, sans-serif;\n\tpadding: 20px;\n\tbackground-color: #f9f9f9;\n}\n\nh1 {\n\tcolor: #333;\n\tmargin-bottom: 20px;\n}\n\ninput[type='text'],\ninput[type='color'],\ninput[type='text'] {\n\twidth: 300px;\n\tpadding: 10px;\n\tmargin-bottom: 20px;\n\tborder: 1px solid #ccc;\n\tborder-radius: 5px;\n\tfont-size: 16px;\n}\n\ninput[type='color'] {\n\theight: 40px;\n\tpadding: 0;\n}\n\nbutton {\n\tpadding: 10px 20px;\n\tbackground-color: #4caf50;\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 5px;\n\tcursor: pointer;\n\tfont-size: 16px;\n}\n\nbutton:hover {\n\tbackground-color: #45a049;\n}\n\nsection {\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tjustify-content: center;\n\tmargin-top: 20px;\n}\n\napp-card {\n\tmargin: 10px;\n\tborder: 1px solid #ddd;\n\tborder-radius: 10px;\n\toverflow: hidden;\n\tbox-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\napp-card:hover {\n\tbox-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n}\n",""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);r&&o[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},601:t=>{t.exports=function(t){return t[1]}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={id:r,exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,h=a?t[e+2]:0,c=i>>2,l=(3&i)<<4|o>>4;let u=(15&o)<<2|h>>6,d=63&h;a||(d=64,s||(u=64)),r.push(n[c],n[l],n[u],n[d])}return r.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const h=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==a||null==h)throw new r;const c=s<<2|o>>4;if(i.push(c),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==h){const t=a<<6&192|h;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class r extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i=function(n){return function(n){const r=t(n);return e.encodeByteArray(r,!0)}(n).replace(/\./g,"")},s=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const n=t&&function(t){try{return e.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return n&&JSON.parse(n)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},o=()=>{var t;return null===(t=s())||void 0===t?void 0:t.config};class a{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function c(){try{return"object"==typeof indexedDB}catch(t){return!1}}class l extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,u.prototype.create)}}class u{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],s=i?function(t,e){return t.replace(d,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new l(r,o,n)}}const d=/\{\$([^}]+)}/g;function f(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(p(n)&&p(s)){if(!f(n,s))return!1}else if(n!==s)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function p(t){return null!==t&&"object"==typeof t}function g(t){return t&&t._delegate?t._delegate:t}class m{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const y="[DEFAULT]";class v{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new a;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:y})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=y){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=y){return this.instances.has(t)}getOptions(t=y){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===y?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=y){return this.component?this.component.multipleInstances?t:y:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class w{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new v(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const b=[];var E;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(E||(E={}));const T={debug:E.DEBUG,verbose:E.VERBOSE,info:E.INFO,warn:E.WARN,error:E.ERROR,silent:E.SILENT},_=E.INFO,I={[E.DEBUG]:"log",[E.VERBOSE]:"log",[E.INFO]:"info",[E.WARN]:"warn",[E.ERROR]:"error"},S=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=I[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class A{constructor(t){this.name=t,this._logLevel=_,this._logHandler=S,this._userLogHandler=null,b.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in E))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?T[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,E.DEBUG,...t),this._logHandler(this,E.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,E.VERBOSE,...t),this._logHandler(this,E.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,E.INFO,...t),this._logHandler(this,E.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,E.WARN,...t),this._logHandler(this,E.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,E.ERROR,...t),this._logHandler(this,E.ERROR,...t)}}const C=(t,e)=>e.some((e=>t instanceof e));let D,N;const k=new WeakMap,x=new WeakMap,O=new WeakMap,R=new WeakMap,L=new WeakMap;let M={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return x.get(t);if("objectStoreNames"===e)return t.objectStoreNames||O.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return V(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function P(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(N||(N=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(F(this),t),V(k.get(this))}:function(...t){return V(e.apply(F(this),t))}:function(t,...n){const r=e.call(F(this),t,...n);return O.set(r,t.sort?t.sort():[t]),V(r)}:(t instanceof IDBTransaction&&function(t){if(x.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));x.set(t,e)}(t),C(t,D||(D=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,M):t);var e}function V(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(V(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&k.set(e,t)})).catch((()=>{})),L.set(e,t),e}(t);if(R.has(t))return R.get(t);const e=P(t);return e!==t&&(R.set(t,e),L.set(e,t)),e}const F=t=>L.get(t),U=["get","getKey","getAll","getAllKeys","count"],B=["put","add","delete","clear"],j=new Map;function $(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(j.get(e))return j.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=B.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!U.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&s.done]))[0]};return j.set(e,s),s}var z;z=M,M={...z,get:(t,e,n)=>$(t,e)||z.get(t,e,n),has:(t,e)=>!!$(t,e)||z.has(t,e)};class q{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const H="@firebase/app",G="0.9.29",K=new A("@firebase/app"),Q="@firebase/app-compat",W="@firebase/analytics-compat",X="@firebase/analytics",J="@firebase/app-check-compat",Y="@firebase/app-check",Z="@firebase/auth",tt="@firebase/auth-compat",et="@firebase/database",nt="@firebase/database-compat",rt="@firebase/functions",it="@firebase/functions-compat",st="@firebase/installations",ot="@firebase/installations-compat",at="@firebase/messaging",ht="@firebase/messaging-compat",ct="@firebase/performance",lt="@firebase/performance-compat",ut="@firebase/remote-config",dt="@firebase/remote-config-compat",ft="@firebase/storage",pt="@firebase/storage-compat",gt="@firebase/firestore",mt="@firebase/firestore-compat",yt="firebase",vt="[DEFAULT]",wt={[H]:"fire-core",[Q]:"fire-core-compat",[X]:"fire-analytics",[W]:"fire-analytics-compat",[Y]:"fire-app-check",[J]:"fire-app-check-compat",[Z]:"fire-auth",[tt]:"fire-auth-compat",[et]:"fire-rtdb",[nt]:"fire-rtdb-compat",[rt]:"fire-fn",[it]:"fire-fn-compat",[st]:"fire-iid",[ot]:"fire-iid-compat",[at]:"fire-fcm",[ht]:"fire-fcm-compat",[ct]:"fire-perf",[lt]:"fire-perf-compat",[ut]:"fire-rc",[dt]:"fire-rc-compat",[ft]:"fire-gcs",[pt]:"fire-gcs-compat",[gt]:"fire-fst",[mt]:"fire-fst-compat","fire-js":"fire-js",[yt]:"fire-js-all"},bt=new Map,Et=new Map;function Tt(t,e){try{t.container.addComponent(e)}catch(n){K.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _t(t){const e=t.name;if(Et.has(e))return K.debug(`There were multiple attempts to register component ${e}.`),!1;Et.set(e,t);for(const e of bt.values())Tt(e,t);return!0}const It=new u("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class St{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new m("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw It.create("app-deleted",{appName:this._name})}}function At(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:vt,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw It.create("bad-app-name",{appName:String(i)});if(n||(n=o()),!n)throw It.create("no-options");const s=bt.get(i);if(s){if(f(n,s.options)&&f(r,s.config))return s;throw It.create("duplicate-app",{appName:i})}const a=new w(i);for(const t of Et.values())a.addComponent(t);const h=new St(n,r,a);return bt.set(i,h),h}function Ct(t,e,n){var r;let i=null!==(r=wt[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void K.warn(t.join(" "))}_t(new m(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const Dt="firebase-heartbeat-database",Nt=1,kt="firebase-heartbeat-store";let xt=null;function Ot(){return xt||(xt=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=V(o);return r&&o.addEventListener("upgradeneeded",(t=>{r(V(o.result),t.oldVersion,t.newVersion,V(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(Dt,Nt,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(kt)}catch(t){console.warn(t)}}}).catch((t=>{throw It.create("idb-open",{originalErrorMessage:t.message})}))),xt}async function Rt(t,e){try{const n=(await Ot()).transaction(kt,"readwrite"),r=n.objectStore(kt);await r.put(e,Lt(t)),await n.done}catch(t){if(t instanceof l)K.warn(t.message);else{const e=It.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});K.warn(e.message)}}}function Lt(t){return`${t.name}!${t.options.appId}`}class Mt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Vt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Pt();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((t=>t.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Pt(),{heartbeatsToSend:n,unsentEntries:r}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),Ft(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ft(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=i(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Pt(){return(new Date).toISOString().substring(0,10)}class Vt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!c()&&new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Ot()).transaction(kt),n=await e.objectStore(kt).get(Lt(t));return await e.done,n}catch(t){if(t instanceof l)K.warn(t.message);else{const e=It.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});K.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Rt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Rt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Ft(t){return i(JSON.stringify({version:2,heartbeats:t})).length}_t(new m("platform-logger",(t=>new q(t)),"PRIVATE")),_t(new m("heartbeat",(t=>new Mt(t)),"PRIVATE")),Ct(H,G,""),Ct(H,G,"esm2017"),Ct("fire-js",""),Ct("firebase","10.9.0","app");var Ut,Bt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},jt={},$t=$t||{},zt=Bt||self;function qt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ht(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Gt="closure_uid_"+(1e9*Math.random()>>>0),Kt=0;function Qt(t,e,n){return t.call.apply(t.bind,arguments)}function Wt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Xt(t,e,n){return(Xt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Qt:Wt).apply(null,arguments)}function Jt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Yt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function Zt(){this.s=this.s,this.o=this.o}Zt.prototype.s=!1,Zt.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Gt)&&t[Gt]||(t[Gt]=++Kt))},Zt.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const te=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function ee(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function ne(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(qt(n)){const e=t.length||0,r=n.length||0;t.length=e+r;for(let i=0;i<r;i++)t[e+i]=n[i]}else t.push(n)}}function re(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var ie=function(){if(!zt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};zt.addEventListener("test",t,e),zt.removeEventListener("test",t,e)}catch(t){}return t}();function se(t){return/^[\s\xa0]*$/.test(t)}function oe(){var t=zt.navigator;return t&&(t=t.userAgent)?t:""}function ae(t){return-1!=oe().indexOf(t)}function he(t){return he[" "](t),t}he[" "]=function(){};var ce,le,ue,de=ae("Opera"),fe=ae("Trident")||ae("MSIE"),pe=ae("Edge"),ge=pe||fe,me=ae("Gecko")&&!(-1!=oe().toLowerCase().indexOf("webkit")&&!ae("Edge"))&&!(ae("Trident")||ae("MSIE"))&&!ae("Edge"),ye=-1!=oe().toLowerCase().indexOf("webkit")&&!ae("Edge");function ve(){var t=zt.document;return t?t.documentMode:void 0}t:{var we="",be=(le=oe(),me?/rv:([^\);]+)(\)|;)/.exec(le):pe?/Edge\/([\d\.]+)/.exec(le):fe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(le):ye?/WebKit\/(\S+)/.exec(le):de?/(?:Version)[ \/]?(\S+)/.exec(le):void 0);if(be&&(we=be?be[1]:""),fe){var Ee=ve();if(null!=Ee&&Ee>parseFloat(we)){ce=String(Ee);break t}}ce=we}zt.document&&fe?ue=ve()||parseInt(ce,10)||void 0:ue=void 0;var Te=ue;function _e(t,e){if(re.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(me){t:{try{he(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ie[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&_e.$.h.call(this)}}Yt(_e,re);var Ie={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),Ae=0;function Ce(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Ae,this.fa=this.ia=!1}function De(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Ne(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function ke(t){const e={};for(const n in t)e[n]=t[n];return e}const xe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Oe(t,e){let n,r;for(let e=1;e<arguments.length;e++){for(n in r=arguments[e],r)t[n]=r[n];for(let e=0;e<xe.length;e++)n=xe[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Re(t){this.src=t,this.g={},this.h=0}function Le(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=te(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(De(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Me(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}Re.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Me(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Ce(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var Pe="closure_lm_"+(1e6*Math.random()|0),Ve={};function Fe(t,e,n,r,i){if(r&&r.once)return Be(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Fe(t,e[s],n,r,i);return null}return n=Ke(n),t&&t[Se]?t.O(e,n,Ht(r)?!!r.capture:!!r,i):Ue(t,e,n,!1,r,i)}function Ue(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Ht(i)?!!i.capture:!!i,a=He(t);if(a||(t[Pe]=a=new Re(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){const t=qe;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ie||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ze(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Be(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Be(t,e[s],n,r,i);return null}return n=Ke(n),t&&t[Se]?t.P(e,n,Ht(r)?!!r.capture:!!r,i):Ue(t,e,n,!0,r,i)}function je(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)je(t,e[s],n,r,i);else r=Ht(r)?!!r.capture:!!r,n=Ke(n),t&&t[Se]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Me(s=t.g[e],n,r,i))&&(De(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=He(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Me(e,n,r,i)),(n=-1<t?e[t]:null)&&$e(n))}function $e(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Se])Le(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ze(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=He(e))?(Le(n,t),0==n.h&&(n.src=null,e[Pe]=null)):De(t)}}}function ze(t){return t in Ve?Ve[t]:Ve[t]="on"+t}function qe(t,e){if(t.fa)t=!0;else{e=new _e(e,this);var n=t.listener,r=t.la||t.src;t.ia&&$e(t),t=n.call(r,e)}return t}function He(t){return(t=t[Pe])instanceof Re?t:null}var Ge="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ke(t){return"function"==typeof t?t:(t[Ge]||(t[Ge]=function(e){return t.handleEvent(e)}),t[Ge])}function Qe(){Zt.call(this),this.i=new Re(this),this.S=this,this.J=null}function We(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new re(e,t);else if(e instanceof re)e.target=e.target||t;else{var i=e;Oe(e=new re(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Xe(o,r,!0,e)&&i}if(i=Xe(o=e.g=t,r,!0,e)&&i,i=Xe(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Xe(o=e.g=n[s],r,!1,e)&&i}function Xe(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,h=o.la||o.src;o.ia&&Le(t.i,o),i=!1!==a.call(h,r)&&i}}return i&&!r.defaultPrevented}Yt(Qe,Zt),Qe.prototype[Se]=!0,Qe.prototype.removeEventListener=function(t,e,n,r){je(this,t,e,n,r)},Qe.prototype.N=function(){if(Qe.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)De(n[r]);delete e.g[t],e.h--}}this.J=null},Qe.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Qe.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Je=zt.JSON.stringify;function Ye(){var t=on;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Ze=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new tn),(t=>t.reset()));class tn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function en(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function nn(t){zt.setTimeout((()=>{throw t}),0)}let rn,sn=!1,on=new class{constructor(){this.h=this.g=null}add(t,e){const n=Ze.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},an=()=>{const t=zt.Promise.resolve(void 0);rn=()=>{t.then(hn)}};var hn=()=>{for(var t;t=Ye();){try{t.h.call(t.g)}catch(t){nn(t)}var e=Ze;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}sn=!1};function cn(t,e){Qe.call(this),this.h=t||1,this.g=e||zt,this.j=Xt(this.qb,this),this.l=Date.now()}function ln(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function un(t,e,n){if("function"==typeof t)n&&(t=Xt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Xt(t.handleEvent,t)}return 2147483647<Number(e)?-1:zt.setTimeout(t,e||0)}function dn(t){t.g=un((()=>{t.g=null,t.i&&(t.i=!1,dn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Yt(cn,Qe),(Ut=cn.prototype).ga=!1,Ut.T=null,Ut.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),We(this,"tick"),this.ga&&(ln(this),this.start()))}},Ut.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ut.N=function(){cn.$.N.call(this),ln(this),delete this.g};class fn extends Zt{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:dn(this)}N(){super.N(),this.g&&(zt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pn(t){Zt.call(this),this.h=t,this.g={}}Yt(pn,Zt);var gn=[];function mn(t,e,n,r){Array.isArray(n)||(n&&(gn[0]=n.toString()),n=gn);for(var i=0;i<n.length;i++){var s=Fe(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function yn(t){Ne(t.g,(function(t,e){this.g.hasOwnProperty(e)&&$e(t)}),t),t.g={}}function vn(){this.g=!0}function wn(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Je(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}pn.prototype.N=function(){pn.$.N.call(this),yn(this)},pn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},vn.prototype.Ea=function(){this.g=!1},vn.prototype.info=function(){};var bn={},En=null;function Tn(){return En=En||new Qe}function _n(t){re.call(this,bn.Ta,t)}function In(t){const e=Tn();We(e,new _n(e))}function Sn(t,e){re.call(this,bn.STAT_EVENT,t),this.stat=e}function An(t){const e=Tn();We(e,new Sn(e,t))}function Cn(t,e){re.call(this,bn.Ua,t),this.size=e}function Dn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return zt.setTimeout((function(){t()}),e)}bn.Ta="serverreachability",Yt(_n,re),bn.STAT_EVENT="statevent",Yt(Sn,re),bn.Ua="timingevent",Yt(Cn,re);var Nn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},kn={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function xn(){}function On(t){return t.h||(t.h=t.i())}function Rn(){}xn.prototype.h=null;var Ln,Mn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Pn(){re.call(this,"d")}function Vn(){re.call(this,"c")}function Fn(){}function Un(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new pn(this),this.P=jn,t=ge?125:void 0,this.V=new cn(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Bn}function Bn(){this.i=null,this.g="",this.h=!1}Yt(Pn,re),Yt(Vn,re),Yt(Fn,xn),Fn.prototype.g=function(){return new XMLHttpRequest},Fn.prototype.i=function(){return{}},Ln=new Fn;var jn=45e3,$n={},zn={};function qn(t,e,n){t.L=1,t.A=cr(ir(e)),t.u=n,t.S=!0,Hn(t,null)}function Hn(t,e){t.G=Date.now(),Wn(t),t.B=ir(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Tr(n.i,"t",r),t.o=0,n=t.l.J,t.h=new Bn,t.g=Ti(t.l,n?e:null,!t.u),0<t.O&&(t.M=new fn(Xt(t.Pa,t,t.g),t.O)),mn(t.U,t.g,"readystatechange",t.nb),e=t.I?ke(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),In(),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),h=0;h<a.length;h++){var c=a[h].split("=");if(1<c.length){var l=c[0];c=c[1];var u=l.split("_");o=2<=u.length&&"type"==u[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Gn(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Kn(t,e,n){let r,i=!0;for(;!t.J&&t.o<n.length;){if(r=Qn(t,n),r==zn){4==e&&(t.s=4,An(14),i=!1),wn(t.j,t.m,null,"[Incomplete Response]");break}if(r==$n){t.s=4,An(15),wn(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}wn(t.j,t.m,r,null),tr(t,r)}Gn(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,An(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),pi(e),e.M=!0,An(11))):(wn(t.j,t.m,n,"[Invalid Chunked Response]"),Zn(t),Yn(t))}function Qn(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?zn:(n=Number(e.substring(n,r)),isNaN(n)?$n:(r+=1)+n>e.length?zn:(e=e.slice(r,r+n),t.o=r+n,e))}function Wn(t){t.Y=Date.now()+t.P,Xn(t,t.P)}function Xn(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Dn(Xt(t.lb,t),e)}function Jn(t){t.C&&(zt.clearTimeout(t.C),t.C=null)}function Yn(t){0==t.l.H||t.J||yi(t.l,t)}function Zn(t){Jn(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,ln(t.V),yn(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function tr(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Nr(n.i,t)))if(!t.K&&Nr(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;mi(n),oi(n)}fi(n),An(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Dn(Xt(n.ib,n),6e3));if(1>=Dr(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else wi(n,11)}else if((t.K||n.g==t)&&mi(n),!se(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const e=c[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const i=c[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const l=c[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(kr(s,s.h),s.h=null))}if(r.F){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.Da=t,hr(r.I,r.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=Ei(r,r.J?r.pa:null,r.Y),o.K){xr(r.i,o);var a=o,h=r.L;h&&a.setTimeout(h),a.C&&(Jn(a),Wn(a)),r.g=o}else di(r);0<n.j.length&&hi(n)}else"stop"!=c[0]&&"close"!=c[0]||wi(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?wi(n,7):si(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}In()}catch(t){}}function er(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(qt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(qt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(qt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(Ut=Un.prototype).setTimeout=function(t){this.P=t},Ut.nb=function(t){t=t.target;const e=this.M;e&&3==Zr(t)?e.l():this.Pa(t)},Ut.Pa=function(t){try{if(t==this.g)t:{const l=Zr(this.g);var e=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||ge||this.g&&(this.h.h||this.g.ja()||ti(this.g)))){this.J||4!=l||7==e||In(),Jn(this);var n=this.g.da();this.ca=n;e:if(Gn(this)){var r=ti(this.g);t="";var i=r.length,s=4==Zr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Zn(this),Yn(this);var o="";break e}this.h.i=new zt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,h=this.g;if((a=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!se(a)){var c=a;break e}}c=null}if(!(n=c)){this.i=!1,this.s=3,An(12),Zn(this),Yn(this);break t}wn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,tr(this,n)}this.S?(Kn(this,l,o),ge&&this.i&&3==l&&(mn(this.U,this.V,"tick",this.mb),this.V.start())):(wn(this.j,this.m,o,null),tr(this,o)),4==l&&Zn(this),this.i&&!this.J&&(4==l?yi(this.l,this):(this.i=!1,Wn(this)))}else(function(t){const e={};t=(t.g&&2<=Zr(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(se(t[r]))continue;var n=en(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,An(12)):(this.s=0,An(13)),Zn(this),Yn(this)}}}catch(t){}},Ut.mb=function(){if(this.g){var t=Zr(this.g),e=this.g.ja();this.o<e.length&&(Jn(this),Kn(this,t,e),this.i&&4!=t&&Wn(this))}},Ut.cancel=function(){this.J=!0,Zn(this)},Ut.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(In(),An(17)),Zn(this),this.s=2,Yn(this)):Xn(this,this.Y-t)};var nr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof rr){this.h=t.h,sr(this,t.j),this.s=t.s,this.g=t.g,or(this,t.m),this.l=t.l;var e=t.i,n=new vr;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),ar(this,n),this.o=t.o}else t&&(e=String(t).match(nr))?(this.h=!1,sr(this,e[1]||"",!0),this.s=lr(e[2]||""),this.g=lr(e[3]||"",!0),or(this,e[4]),this.l=lr(e[5]||"",!0),ar(this,e[6]||"",!0),this.o=lr(e[7]||"")):(this.h=!1,this.i=new vr(null,this.h))}function ir(t){return new rr(t)}function sr(t,e,n){t.j=n?lr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function or(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ar(t,e,n){e instanceof vr?(t.i=e,function(t,e){e&&!t.j&&(wr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(br(this,e),Tr(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=ur(e,mr)),t.i=new vr(e,t.h))}function hr(t,e,n){t.i.set(e,n)}function cr(t){return hr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function lr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ur(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,dr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function dr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}rr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ur(e,fr,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ur(e,fr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ur(n,"/"==n.charAt(0)?gr:pr,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ur(n,yr)),t.join("")};var fr=/[#\/\?@]/g,pr=/[#\?:]/g,gr=/[#\?]/g,mr=/[#\?@]/g,yr=/#/g;function vr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function wr(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function br(t,e){wr(t),e=_r(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Er(t,e){return wr(t),e=_r(t,e),t.g.has(e)}function Tr(t,e,n){br(t,e),0<n.length&&(t.i=null,t.g.set(_r(t,e),ee(n)),t.h+=n.length)}function _r(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ut=vr.prototype).add=function(t,e){wr(this),this.i=null,t=_r(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ut.forEach=function(t,e){wr(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},Ut.ta=function(){wr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},Ut.Z=function(t){wr(this);let e=[];if("string"==typeof t)Er(this,t)&&(e=e.concat(this.g.get(_r(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Ut.set=function(t,e){return wr(this),this.i=null,Er(this,t=_r(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ut.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Ut.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var Ir=class{constructor(t,e){this.g=t,this.map=e}};function Sr(t){this.l=t||Ar,t=zt.PerformanceNavigationTiming?0<(t=zt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(zt.g&&zt.g.Ka&&zt.g.Ka()&&zt.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ar=10;function Cr(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Dr(t){return t.h?1:t.g?t.g.size:0}function Nr(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function kr(t,e){t.g?t.g.add(e):t.h=e}function xr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Or(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return ee(t.i)}Sr.prototype.cancel=function(){if(this.i=Or(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Rr=class{stringify(t){return zt.JSON.stringify(t,void 0)}parse(t){return zt.JSON.parse(t,void 0)}};function Lr(){this.g=new Rr}function Mr(t,e,n){const r=n||"";try{er(t,(function(t,n){let i=t;Ht(t)&&(i=Je(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Pr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Vr(t){this.l=t.ec||null,this.j=t.ob||!1}function Fr(t,e){Qe.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Ur,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Yt(Vr,xn),Vr.prototype.g=function(){return new Fr(this.l,this.j)},Vr.prototype.i=function(t){return function(){return t}}({}),Yt(Fr,Qe);var Ur=0;function Br(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function jr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,$r(t)}function $r(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ut=Fr.prototype).open=function(t,e){if(this.readyState!=Ur)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,$r(this)},Ut.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||zt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Ut.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jr(this)),this.readyState=Ur},Ut.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,$r(this)),this.g&&(this.readyState=3,$r(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==zt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Br(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Ut.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?jr(this):$r(this),3==this.readyState&&Br(this)}},Ut.Za=function(t){this.g&&(this.response=this.responseText=t,jr(this))},Ut.Ya=function(t){this.g&&(this.response=t,jr(this))},Ut.ka=function(){this.g&&jr(this)},Ut.setRequestHeader=function(t,e){this.v.append(t,e)},Ut.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ut.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Fr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var zr=zt.JSON.parse;function qr(t){Qe.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Hr,this.L=this.M=!1}Yt(qr,Qe);var Hr="",Gr=/^https?$/i,Kr=["POST","PUT"];function Qr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Wr(t),Jr(t)}function Wr(t){t.F||(t.F=!0,We(t,"complete"),We(t,"error"))}function Xr(t){if(t.h&&void 0!==$t&&(!t.C[1]||4!=Zr(t)||2!=t.da()))if(t.v&&4==Zr(t))un(t.La,0,t);else if(We(t,"readystatechange"),4==Zr(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(nr)[1]||null;!i&&zt.self&&zt.self.location&&(i=zt.self.location.protocol.slice(0,-1)),r=!Gr.test(i?i.toLowerCase():"")}n=r}if(n)We(t,"complete"),We(t,"success");else{t.m=6;try{var s=2<Zr(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Wr(t)}}finally{Jr(t)}}}function Jr(t,e){if(t.g){Yr(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||We(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Yr(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(zt.clearTimeout(t.A),t.A=null)}function Zr(t){return t.g?t.g.readyState:0}function ti(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Hr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ei(t){let e="";return Ne(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function ni(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=ei(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):hr(t,e,n))}function ri(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ii(t){this.Ga=0,this.j=[],this.l=new vn,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ri("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ri("baseRetryDelayMs",5e3,t),this.hb=ri("retryDelaySeedMs",1e4,t),this.eb=ri("forwardChannelMaxRetries",2,t),this.xa=ri("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Sr(t&&t.concurrentRequestLimit),this.Ja=new Lr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function si(t){if(ai(t),3==t.H){var e=t.W++,n=ir(t.I);if(hr(n,"SID",t.K),hr(n,"RID",e),hr(n,"TYPE","terminate"),li(t,n),(e=new Un(t,t.l,e)).L=2,e.A=cr(ir(n)),n=!1,zt.navigator&&zt.navigator.sendBeacon)try{n=zt.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&zt.Image&&((new Image).src=e.A,n=!0),n||(e.g=Ti(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Wn(e)}bi(t)}function oi(t){t.g&&(pi(t),t.g.cancel(),t.g=null)}function ai(t){oi(t),t.u&&(zt.clearTimeout(t.u),t.u=null),mi(t),t.i.cancel(),t.m&&("number"==typeof t.m&&zt.clearTimeout(t.m),t.m=null)}function hi(t){if(!Cr(t.i)&&!t.m){t.m=!0;var e=t.Na;rn||an(),sn||(rn(),sn=!0),on.add(e,t),t.C=0}}function ci(t,e){var n;n=e?e.m:t.W++;const r=ir(t.I);hr(r,"SID",t.K),hr(r,"RID",n),hr(r,"AID",t.V),li(t,r),t.o&&t.s&&ni(r,t.o,t.s),n=new Un(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=ui(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),kr(t.i,n),qn(n,r,e)}function li(t,e){t.na&&Ne(t.na,(function(t,n){hr(e,n,t)})),t.h&&er({},(function(t,n){hr(e,n,t)}))}function ui(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Xt(t.h.Va,t.h,t):null;t:{var i=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=e,0>n)e=Math.max(0,i[o].g-100),s=!1;else try{Mr(a,t,"req"+n+"_")}catch(t){r&&r(a)}}if(s){r=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,r}function di(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;rn||an(),sn||(rn(),sn=!0),on.add(e,t),t.A=0}}function fi(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Dn(Xt(t.Ma,t),vi(t,t.A)),t.A++,0))}function pi(t){null!=t.B&&(zt.clearTimeout(t.B),t.B=null)}function gi(t){t.g=new Un(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=ir(t.wa);hr(e,"RID","rpc"),hr(e,"SID",t.K),hr(e,"AID",t.V),hr(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&hr(e,"TO",t.qa),hr(e,"TYPE","xmlhttp"),li(t,e),t.o&&t.s&&ni(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=cr(ir(e)),n.u=null,n.S=!0,Hn(n,t)}function mi(t){null!=t.v&&(zt.clearTimeout(t.v),t.v=null)}function yi(t,e){var n=null;if(t.g==e){mi(t),pi(t),t.g=null;var r=2}else{if(!Nr(t.i,e))return;n=e.F,xr(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;We(r=Tn(),new Cn(r,n)),hi(t)}else di(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function(t,e){return!(Dr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Dn(Xt(t.Na,t,e),vi(t,t.C)),t.C++,0)))}(t,e)||2==r&&fi(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:wi(t,5);break;case 4:wi(t,10);break;case 3:wi(t,6);break;default:wi(t,2)}}function vi(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function wi(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=Xt(t.pb,t);n||(n=new rr("//www.google.com/images/cleardot.gif"),zt.location&&"http"==zt.location.protocol||sr(n,"https"),cr(n)),function(t,e){const n=new vn;if(zt.Image){const r=new Image;r.onload=Jt(Pr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Jt(Pr,n,r,"TestLoadImage: error",!1,e),r.onabort=Jt(Pr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Jt(Pr,n,r,"TestLoadImage: timeout",!1,e),zt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else An(2);t.H=0,t.h&&t.h.za(e),bi(t),ai(t)}function bi(t){if(t.H=0,t.ma=[],t.h){const e=Or(t.i);0==e.length&&0==t.j.length||(ne(t.ma,e),ne(t.ma,t.j),t.i.i.length=0,ee(t.j),t.j.length=0),t.h.ya()}}function Ei(t,e,n){var r=n instanceof rr?ir(n):new rr(n);if(""!=r.g)e&&(r.g=e+"."+r.g),or(r,r.m);else{var i=zt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new rr(null);r&&sr(s,r),e&&(s.g=e),i&&or(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&hr(r,n,e),hr(r,"VER",t.ra),li(t,r),r}function Ti(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new qr(new Vr({ob:n})):new qr(t.va)).Oa(t.J),e}function _i(){}function Ii(){if(fe&&!(10<=Number(Te)))throw Error("Environmental error: no available transport.")}function Si(t,e){Qe.call(this),this.g=new ii(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!se(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!se(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Di(this)}function Ai(t){Pn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Ci(){Vn.call(this),this.status=1}function Di(t){this.g=t}function Ni(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ki(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function xi(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(Ut=qr.prototype).Oa=function(t){this.M=t},Ut.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ln.g(),this.C=this.u?On(this.u):On(Ln),this.g.onreadystatechange=Xt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Qr(this,t)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=zt.FormData&&t instanceof zt.FormData,!(0<=te(Kr,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Yr(this),0<this.B&&((this.L=function(t){return fe&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Xt(this.ua,this)):this.A=un(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Qr(this,t)}},Ut.ua=function(){void 0!==$t&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,We(this,"timeout"),this.abort(8))},Ut.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,We(this,"complete"),We(this,"abort"),Jr(this))},Ut.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Jr(this,!0)),qr.$.N.call(this)},Ut.La=function(){this.s||(this.G||this.v||this.l?Xr(this):this.kb())},Ut.kb=function(){Xr(this)},Ut.isActive=function(){return!!this.g},Ut.da=function(){try{return 2<Zr(this)?this.g.status:-1}catch(t){return-1}},Ut.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ut.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),zr(e)}},Ut.Ia=function(){return this.m},Ut.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ut=ii.prototype).ra=8,Ut.H=1,Ut.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Un(this,this.l,t);let s=this.s;if(this.U&&(s?(s=ke(s),Oe(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ui(this,i,e),hr(n=ir(this.I),"RID",t),hr(n,"CVER",22),this.F&&hr(n,"X-HTTP-Session-Id",this.F),li(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(ei(s)))+"&"+e:this.o&&ni(n,this.o,s)),kr(this.i,i),this.bb&&hr(n,"TYPE","init"),this.P?(hr(n,"$req",e),hr(n,"SID","null"),i.aa=!0,qn(i,n,null)):qn(i,n,e),this.H=2}}else 3==this.H&&(t?ci(this,t):0==this.j.length||Cr(this.i)||ci(this))},Ut.Ma=function(){if(this.u=null,gi(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Dn(Xt(this.jb,this),t)}},Ut.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,An(10),oi(this),gi(this))},Ut.ib=function(){null!=this.v&&(this.v=null,oi(this),fi(this),An(19))},Ut.pb=function(t){t?(this.l.info("Successfully pinged google.com"),An(2)):(this.l.info("Failed to ping google.com"),An(1))},Ut.isActive=function(){return!!this.h&&this.h.isActive(this)},(Ut=_i.prototype).Ba=function(){},Ut.Aa=function(){},Ut.za=function(){},Ut.ya=function(){},Ut.isActive=function(){return!0},Ut.Va=function(){},Ii.prototype.g=function(t,e){return new Si(t,e)},Yt(Si,Qe),Si.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;An(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Ei(t,null,t.Y),hi(t)},Si.prototype.close=function(){si(this.g)},Si.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Je(t),t=n);e.j.push(new Ir(e.fb++,t)),3==e.H&&hi(e)},Si.prototype.N=function(){this.g.h=null,delete this.j,si(this.g),delete this.g,Si.$.N.call(this)},Yt(Ai,Pn),Yt(Ci,Vn),Yt(Di,_i),Di.prototype.Ba=function(){We(this.g,"a")},Di.prototype.Aa=function(t){We(this.g,new Ai(t))},Di.prototype.za=function(t){We(this.g,new Ci)},Di.prototype.ya=function(){We(this.g,"b")},Yt(Ni,(function(){this.blockSize=-1})),Ni.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ni.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)ki(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){ki(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){ki(this,r),i=0;break}}this.h=i,this.i+=e},Ni.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var Oi={};function Ri(t){return-128<=t&&128>t?function(t,e){var n=Oi;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new xi([0|t],0>t?-1:0)}(t)}(t):new xi([0|t],0>t?-1:0)}function Li(t){if(isNaN(t)||!isFinite(t))return Pi;if(0>t)return ji(Li(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Mi;return new xi(e,0)}var Mi=4294967296,Pi=Ri(0),Vi=Ri(1),Fi=Ri(16777216);function Ui(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Bi(t){return-1==t.h}function ji(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new xi(n,~t.h).add(Vi)}function $i(t,e){return t.add(ji(e))}function zi(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function qi(t,e){this.g=t,this.h=e}function Hi(t,e){if(Ui(e))throw Error("division by zero");if(Ui(t))return new qi(Pi,Pi);if(Bi(t))return e=Hi(ji(t),e),new qi(ji(e.g),ji(e.h));if(Bi(e))return e=Hi(t,ji(e)),new qi(ji(e.g),e.h);if(30<t.g.length){if(Bi(t)||Bi(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Vi,r=e;0>=r.X(t);)n=Gi(n),r=Gi(r);var i=Ki(n,1),s=Ki(r,1);for(r=Ki(r,2),n=Ki(n,2);!Ui(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ki(r,1),n=Ki(n,1)}return e=$i(t,i.R(e)),new qi(i,e)}for(i=Pi;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Li(n)).R(e);Bi(o)||0<o.X(t);)o=(s=Li(n-=r)).R(e);Ui(s)&&(s=Vi),i=i.add(s),t=$i(t,o)}return new qi(i,t)}function Gi(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new xi(n,t.h)}function Ki(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new xi(i,t.h)}(Ut=xi.prototype).ea=function(){if(Bi(this))return-ji(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Mi+r)*e,e*=Mi}return t},Ut.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Ui(this))return"0";if(Bi(this))return"-"+ji(this).toString(t);for(var e=Li(Math.pow(t,6)),n=this,r="";;){var i=Hi(n,e).g,s=((0<(n=$i(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Ui(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Ut.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Ut.X=function(t){return Bi(t=$i(this,t))?-1:Ui(t)?0:1},Ut.abs=function(){return Bi(this)?ji(this):this},Ut.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new xi(n,-2147483648&n[n.length-1]?-1:0)},Ut.R=function(t){if(Ui(this)||Ui(t))return Pi;if(Bi(this))return Bi(t)?ji(this).R(ji(t)):ji(ji(this).R(t));if(Bi(t))return ji(this.R(ji(t)));if(0>this.X(Fi)&&0>t.X(Fi))return Li(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,h=65535&t.D(i);n[2*r+2*i]+=o*h,zi(n,2*r+2*i),n[2*r+2*i+1]+=s*h,zi(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,zi(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,zi(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new xi(n,0)},Ut.gb=function(t){return Hi(this,t).h},Ut.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new xi(n,this.h&t.h)},Ut.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new xi(n,this.h|t.h)},Ut.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new xi(n,this.h^t.h)},Ii.prototype.createWebChannel=Ii.prototype.g,Si.prototype.send=Si.prototype.u,Si.prototype.open=Si.prototype.m,Si.prototype.close=Si.prototype.close,Nn.NO_ERROR=0,Nn.TIMEOUT=8,Nn.HTTP_ERROR=6,kn.COMPLETE="complete",Rn.EventType=Mn,Mn.OPEN="a",Mn.CLOSE="b",Mn.ERROR="c",Mn.MESSAGE="d",Qe.prototype.listen=Qe.prototype.O,qr.prototype.listenOnce=qr.prototype.P,qr.prototype.getLastError=qr.prototype.Sa,qr.prototype.getLastErrorCode=qr.prototype.Ia,qr.prototype.getStatus=qr.prototype.da,qr.prototype.getResponseJson=qr.prototype.Wa,qr.prototype.getResponseText=qr.prototype.ja,qr.prototype.send=qr.prototype.ha,qr.prototype.setWithCredentials=qr.prototype.Oa,Ni.prototype.digest=Ni.prototype.l,Ni.prototype.reset=Ni.prototype.reset,Ni.prototype.update=Ni.prototype.j,xi.prototype.add=xi.prototype.add,xi.prototype.multiply=xi.prototype.R,xi.prototype.modulo=xi.prototype.gb,xi.prototype.compare=xi.prototype.X,xi.prototype.toNumber=xi.prototype.ea,xi.prototype.toString=xi.prototype.toString,xi.prototype.getBits=xi.prototype.D,xi.fromNumber=Li,xi.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return ji(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Li(Math.pow(n,8)),i=Pi,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=Li(Math.pow(n,o)),i=i.R(o).add(Li(a))):i=(i=i.R(r)).add(Li(a))}return i};var Qi=jt.createWebChannelTransport=function(){return new Ii},Wi=jt.getStatEventTarget=function(){return Tn()},Xi=jt.ErrorCode=Nn,Ji=jt.EventType=kn,Yi=jt.Event=bn,Zi=jt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ts=(jt.FetchXmlHttpFactory=Vr,jt.WebChannel=Rn),es=jt.XhrIo=qr,ns=(jt.Md5=Ni,jt.Integer=xi);const rs="@firebase/firestore";class is{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}is.UNAUTHENTICATED=new is(null),is.GOOGLE_CREDENTIALS=new is("google-credentials-uid"),is.FIRST_PARTY=new is("first-party-uid"),is.MOCK_USER=new is("mock-user");let ss="10.9.0";const os=new A("@firebase/firestore");function as(){return os.logLevel}function hs(t,...e){if(os.logLevel<=E.DEBUG){const n=e.map(us);os.debug(`Firestore (${ss}): ${t}`,...n)}}function cs(t,...e){if(os.logLevel<=E.ERROR){const n=e.map(us);os.error(`Firestore (${ss}): ${t}`,...n)}}function ls(t,...e){if(os.logLevel<=E.WARN){const n=e.map(us);os.warn(`Firestore (${ss}): ${t}`,...n)}}function us(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function ds(t="Unexpected state"){const e=`FIRESTORE (${ss}) INTERNAL ASSERTION FAILED: `+t;throw cs(e),new Error(e)}function fs(t,e){t||ds()}function ps(t,e){return t}const gs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ms extends l{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ys{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class vs{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ws{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(is.UNAUTHENTICATED)))}shutdown(){}}class bs{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Es{constructor(t){this.t=t,this.currentUser=is.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new ys;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ys,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{hs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(hs("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ys)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(hs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(fs("string"==typeof e.accessToken),new vs(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return fs(null===t||"string"==typeof t),new is(t)}}class Ts{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=is.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class _s{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Ts(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(is.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Is{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ss{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&hs("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,hs("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const r=t=>{hs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>r(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?r(t):hs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(fs("string"==typeof t.token),this.R=t.token,new Is(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function As(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Cs{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=As(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function Ds(t,e){return t<e?-1:t>e?1:0}function Ns(t,e,n){return t.length===e.length&&t.every(((t,r)=>n(t,e[r])))}class ks{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ms(gs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ms(gs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ms(gs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ms(gs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ks.fromMillis(Date.now())}static fromDate(t){return ks.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new ks(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Ds(this.nanoseconds,t.nanoseconds):Ds(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class xs{constructor(t){this.timestamp=t}static fromTimestamp(t){return new xs(t)}static min(){return new xs(new ks(0,0))}static max(){return new xs(new ks(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Os{constructor(t,e,n){void 0===e?e=0:e>t.length&&ds(),void 0===n?n=t.length-e:n>t.length-e&&ds(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Os.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Os?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Rs extends Os{construct(t,e,n){return new Rs(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new ms(gs.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Rs(e)}static emptyPath(){return new Rs([])}}const Ls=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ms extends Os{construct(t,e,n){return new Ms(t,e,n)}static isValidIdentifier(t){return Ls.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ms.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ms(["__name__"])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new ms(gs.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new ms(gs.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new ms(gs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new ms(gs.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ms(e)}static emptyPath(){return new Ms([])}}class Ps{constructor(t){this.path=t}static fromPath(t){return new Ps(Rs.fromString(t))}static fromName(t){return new Ps(Rs.fromString(t).popFirst(5))}static empty(){return new Ps(Rs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Rs.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Rs.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ps(new Rs(t.slice()))}}function Vs(t){return new Fs(t.readTime,t.key,-1)}class Fs{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Fs(xs.min(),Ps.empty(),-1)}static max(){return new Fs(xs.max(),Ps.empty(),-1)}}function Us(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Ps.comparator(t.documentKey,e.documentKey),0!==n?n:Ds(t.largestBatchId,e.largestBatchId))}const Bs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class js{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function $s(t){if(t.code!==gs.FAILED_PRECONDITION||t.message!==Bs)throw t;hs("LocalStore","Unexpectedly lost primary lease")}class zs{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ds(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new zs(((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof zs?e:zs.resolve(e)}catch(t){return zs.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):zs.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):zs.reject(e)}static resolve(t){return new zs(((e,n)=>{e(t)}))}static reject(t){return new zs(((e,n)=>{n(t)}))}static waitFor(t){return new zs(((e,n)=>{let r=0,i=0,s=!1;t.forEach((t=>{++r,t.next((()=>{++i,s&&i===r&&e()}),(t=>n(t)))})),s=!0,i===r&&e()}))}static or(t){let e=zs.resolve(!1);for(const n of t)e=e.next((t=>t?zs.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,r)=>{n.push(e.call(this,t,r))})),this.waitFor(n)}static mapArray(t,e){return new zs(((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const h=a;e(t[h]).next((t=>{s[h]=t,++o,o===i&&n(s)}),(t=>r(t)))}}))}static doWhile(t,e){return new zs(((n,r)=>{const i=()=>{!0===t()?e().next((()=>{i()}),r):n()};i()}))}}class qs{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new ys,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Ks(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Ys(e.target.error);this.V.reject(new Ks(t,n))}}static open(t,e,n,r){try{return new qs(e,t.transaction(r,n))}catch(t){throw new Ks(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(hs("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Ws(e)}}class Hs{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Hs.S(h())&&cs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return hs("SimpleDb","Removing database:",t),Xs(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!c())return!1;if(Hs.C())return!0;const t=h(),e=Hs.S(t),n=0<e&&e<10,r=Hs.v(t),i=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||i)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(hs("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=t=>{const n=t.target.result;e(n)},r.onblocked=()=>{n(new Ks(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=e=>{const r=e.target.error;"VersionError"===r.name?n(new ms(gs.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new ms(gs.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Ks(t,r))},r.onupgradeneeded=t=>{hs("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,r.transaction,t.oldVersion,this.version).next((()=>{hs("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db}B(t){this.L=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,r){const i="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=qs.open(this.db,t,i?"readonly":"readwrite",n),s=r(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),zs.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(hs("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Gs{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Xs(this.k.delete())}}class Ks extends ms{constructor(t,e){super(gs.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Qs(t){return"IndexedDbTransactionError"===t.name}class Ws{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(hs("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(hs("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Xs(n)}add(t){return hs("SimpleDb","ADD",this.store.name,t,t),Xs(this.store.add(t))}get(t){return Xs(this.store.get(t)).next((e=>(void 0===e&&(e=null),hs("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return hs("SimpleDb","DELETE",this.store.name,t),Xs(this.store.delete(t))}count(){return hs("SimpleDb","COUNT",this.store.name),Xs(this.store.count())}W(t,e){const n=this.options(t,e),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const t=r.getAll(n.range);return new zs(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new zs(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){hs("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const r=this.cursor(n);return this.G(r,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const r=this.cursor(n);return this.G(r,e)}Z(t){const e=this.cursor({});return new zs(((n,r)=>{e.onerror=t=>{const e=Ys(t.target.error);r(e)},e.onsuccess=e=>{const r=e.target.result;r?t(r.primaryKey,r.value).next((t=>{t?r.continue():n()})):n()}}))}G(t,e){const n=[];return new zs(((r,i)=>{t.onerror=t=>{i(t.target.error)},t.onsuccess=t=>{const i=t.target.result;if(!i)return void r();const s=new Gs(i),o=e(i.primaryKey,i.value,s);if(o instanceof zs){const t=o.catch((t=>(s.done(),zs.reject(t))));n.push(t)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>zs.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Xs(t){return new zs(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Ys(t.target.error);n(e)}}))}let Js=!1;function Ys(t){const e=Hs.S(h());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new ms("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Js||(Js=!0,setTimeout((()=>{throw t}),0)),t}}return t}class Zs{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function to(t){return null==t}function eo(t){return 0===t&&1/t==-1/0}Zs._e=-1;function no(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ro(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function io(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class so{constructor(t,e){this.comparator=t,this.root=e||ao.EMPTY}insert(t,e){return new so(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ao.BLACK,null,null))}remove(t){return new so(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ao.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new oo(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new oo(this.root,t,this.comparator,!1)}getReverseIterator(){return new oo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new oo(this.root,t,this.comparator,!0)}}class oo{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ao{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:ao.RED,this.left=null!=r?r:ao.EMPTY,this.right=null!=i?i:ao.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new ao(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ao.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return ao.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ao.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ao.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ds();if(this.right.isRed())throw ds();const t=this.left.check();if(t!==this.right.check())throw ds();return t+(this.isRed()?0:1)}}ao.EMPTY=null,ao.RED=!0,ao.BLACK=!1,ao.EMPTY=new class{constructor(){this.size=0}get key(){throw ds()}get value(){throw ds()}get color(){throw ds()}get left(){throw ds()}get right(){throw ds()}copy(t,e,n,r,i){return this}insert(t,e,n){return new ao(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ho{constructor(t){this.comparator=t,this.data=new so(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new co(this.data.getIterator())}getIteratorFrom(t){return new co(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ho(this.comparator);return e.data=t,e}}class co{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class lo{constructor(t){this.fields=t,t.sort(Ms.comparator)}static empty(){return new lo([])}unionWith(t){let e=new ho(Ms.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new lo(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ns(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class uo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fo{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new uo("Invalid base64 string: "+t):t}}(t);return new fo(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new fo(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Ds(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}fo.EMPTY_BYTE_STRING=new fo("");const po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(fs(!!t),"string"==typeof t){let e=0;const n=po.exec(t);if(fs(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mo(t.seconds),nanos:mo(t.nanos)}}function mo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function yo(t){return"string"==typeof t?fo.fromBase64String(t):fo.fromUint8Array(t)}function vo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function wo(t){const e=t.mapValue.fields.__previous_value__;return vo(e)?wo(e):e}function bo(t){const e=go(t.mapValue.fields.__local_write_time__.timestampValue);return new ks(e.seconds,e.nanos)}class Eo{constructor(t,e,n,r,i,s,o,a,h){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=h}}class To{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new To("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof To&&t.projectId===this.projectId&&t.database===this.database}}const _o={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vo(t)?4:Mo(t)?9007199254740991:10:ds()}function So(t,e){if(t===e)return!0;const n=Io(t);if(n!==Io(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bo(t).isEqual(bo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=go(t.timestampValue),r=go(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return yo(t.bytesValue).isEqual(yo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return mo(t.geoPointValue.latitude)===mo(e.geoPointValue.latitude)&&mo(t.geoPointValue.longitude)===mo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return mo(t.integerValue)===mo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=mo(t.doubleValue),r=mo(e.doubleValue);return n===r?eo(n)===eo(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ns(t.arrayValue.values||[],e.arrayValue.values||[],So);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(no(n)!==no(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!So(n[t],r[t])))return!1;return!0}(t,e);default:return ds()}}function Ao(t,e){return void 0!==(t.values||[]).find((t=>So(t,e)))}function Co(t,e){if(t===e)return 0;const n=Io(t),r=Io(e);if(n!==r)return Ds(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ds(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=mo(t.integerValue||t.doubleValue),r=mo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Do(t.timestampValue,e.timestampValue);case 4:return Do(bo(t),bo(e));case 5:return Ds(t.stringValue,e.stringValue);case 6:return function(t,e){const n=yo(t),r=yo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=Ds(n[t],r[t]);if(0!==e)return e}return Ds(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Ds(mo(t.latitude),mo(e.latitude));return 0!==n?n:Ds(mo(t.longitude),mo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=Co(n[t],r[t]);if(e)return e}return Ds(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===_o.mapValue&&e===_o.mapValue)return 0;if(t===_o.mapValue)return 1;if(e===_o.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=Ds(r[t],s[t]);if(0!==e)return e;const o=Co(n[r[t]],i[s[t]]);if(0!==o)return o}return Ds(r.length,s.length)}(t.mapValue,e.mapValue);default:throw ds()}}function Do(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ds(t,e);const n=go(t),r=go(e),i=Ds(n.seconds,r.seconds);return 0!==i?i:Ds(n.nanos,r.nanos)}function No(t){return ko(t)}function ko(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=go(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return yo(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Ps.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=ko(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+=`${i}:${ko(t.fields[i])}`;return n+"}"}(t.mapValue):ds()}function xo(t){return!!t&&"integerValue"in t}function Oo(t){return!!t&&"arrayValue"in t}function Ro(t){return!!t&&"mapValue"in t}function Lo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ro(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Lo(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Mo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Po{constructor(t){this.value=t}static empty(){return new Po({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Ro(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Lo(e)}setAll(t){let e=Ms.emptyPath(),n={},r=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=Lo(t):r.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());Ro(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return So(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];Ro(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){ro(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Po(Lo(this.value))}}function Vo(t){const e=[];return ro(t.fields,((t,n)=>{const r=new Ms([t]);if(Ro(n)){const t=Vo(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)})),new lo(e)}class Fo{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Fo(t,0,xs.min(),xs.min(),xs.min(),Po.empty(),0)}static newFoundDocument(t,e,n,r){return new Fo(t,1,e,xs.min(),n,r,0)}static newNoDocument(t,e){return new Fo(t,2,e,xs.min(),xs.min(),Po.empty(),0)}static newUnknownDocument(t,e){return new Fo(t,3,e,xs.min(),xs.min(),Po.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(xs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Po.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Po.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xs.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Fo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Fo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Uo{constructor(t,e){this.position=t,this.inclusive=e}}function Bo(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?Ps.comparator(Ps.fromName(o.referenceValue),n.key):Co(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function jo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!So(t.position[n],e.position[n]))return!1;return!0}class $o{constructor(t,e="asc"){this.field=t,this.dir=e}}function zo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class qo{}class Ho extends qo{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Yo(t,e,n):"array-contains"===e?new na(t,n):"in"===e?new ra(t,n):"not-in"===e?new ia(t,n):"array-contains-any"===e?new sa(t,n):new Ho(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Zo(t,n):new ta(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Co(e,this.value)):null!==e&&Io(this.value)===Io(e)&&this.matchesComparison(Co(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ds()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Go extends qo{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Go(t,e)}matches(t){return Ko(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Ko(t){return"and"===t.op}function Qo(t){return function(t){for(const e of t.filters)if(e instanceof Go)return!1;return!0}(t)&&Ko(t)}function Wo(t){if(t instanceof Ho)return t.field.canonicalString()+t.op.toString()+No(t.value);if(Qo(t))return t.filters.map((t=>Wo(t))).join(",");{const e=t.filters.map((t=>Wo(t))).join(",");return`${t.op}(${e})`}}function Xo(t,e){return t instanceof Ho?function(t,e){return e instanceof Ho&&t.op===e.op&&t.field.isEqual(e.field)&&So(t.value,e.value)}(t,e):t instanceof Go?function(t,e){return e instanceof Go&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,r)=>t&&Xo(n,e.filters[r])),!0)}(t,e):void ds()}function Jo(t){return t instanceof Ho?function(t){return`${t.field.canonicalString()} ${t.op} ${No(t.value)}`}(t):t instanceof Go?function(t){return t.op.toString()+" {"+t.getFilters().map(Jo).join(" ,")+"}"}(t):"Filter"}class Yo extends Ho{constructor(t,e,n){super(t,e,n),this.key=Ps.fromName(n.referenceValue)}matches(t){const e=Ps.comparator(t.key,this.key);return this.matchesComparison(e)}}class Zo extends Ho{constructor(t,e){super(t,"in",e),this.keys=ea(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class ta extends Ho{constructor(t,e){super(t,"not-in",e),this.keys=ea(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function ea(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Ps.fromName(t.referenceValue)))}class na extends Ho{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Oo(e)&&Ao(e.arrayValue,this.value)}}class ra extends Ho{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ao(this.value.arrayValue,e)}}class ia extends Ho{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ao(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ao(this.value.arrayValue,e)}}class sa extends Ho{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Oo(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ao(this.value.arrayValue,t)))}}class oa{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function aa(t,e=null,n=[],r=[],i=null,s=null,o=null){return new oa(t,e,n,r,i,s,o)}function ha(t){const e=ps(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Wo(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),to(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>No(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>No(t))).join(",")),e.ce=t}return e.ce}function ca(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Xo(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!jo(t.startAt,e.startAt)&&jo(t.endAt,e.endAt)}class la{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function ua(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function da(t){const e=ps(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new ho(Ms.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);r.forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.le.push(new $o(r,n))})),t.has(Ms.keyField().canonicalString())||e.le.push(new $o(Ms.keyField(),n))}return e.le}function fa(t){const e=ps(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return aa(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new $o(t.field,e)}));const n=t.endAt?new Uo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Uo(t.startAt.position,t.startAt.inclusive):null;return aa(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,da(t))),e.he}function pa(t,e,n){return new la(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ga(t,e){return ca(fa(t),fa(e))&&t.limitType===e.limitType}function ma(t){return`${ha(fa(t))}|lt:${t.limitType}`}function ya(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Jo(t))).join(", ")}]`),to(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>No(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>No(t))).join(",")),`Target(${e})`}(fa(t))}; limitType=${t.limitType})`}function va(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ps.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of da(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=Bo(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,da(t),e)||t.endAt&&!function(t,e,n){const r=Bo(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,da(t),e))}(t,e)}function wa(t,e,n){const r=t.field.isKeyField()?Ps.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Co(r,i):ds()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ds()}}class ba{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,r]of n)if(this.equalsFn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){ro(this.inner,((e,n)=>{for(const[e,r]of n)t(e,r)}))}isEmpty(){return io(this.inner)}size(){return this.innerSize}}const Ea=new so(Ps.comparator);function Ta(){return Ea}const _a=new so(Ps.comparator);function Ia(...t){let e=_a;for(const n of t)e=e.insert(n.key,n);return e}function Sa(t){let e=_a;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Aa(){return Da()}function Ca(){return Da()}function Da(){return new ba((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Na=new so(Ps.comparator),ka=new ho(Ps.comparator);function xa(...t){let e=ka;for(const n of t)e=e.add(n);return e}const Oa=new ho(Ds);function Ra(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eo(e)?"-0":e}}function La(t){return{integerValue:""+t}}function Ma(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!eo(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?La(e):Ra(t,e)}class Pa{constructor(){this._=void 0}}function Va(t,e,n){return t instanceof Ba?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&vo(e)&&(e=wo(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ja?$a(t,e):t instanceof za?qa(t,e):function(t,e){const n=Ua(t,e),r=Ga(n)+Ga(t.Ie);return xo(n)&&xo(t.Ie)?La(r):Ra(t.serializer,r)}(t,e)}function Fa(t,e,n){return t instanceof ja?$a(t,e):t instanceof za?qa(t,e):n}function Ua(t,e){return t instanceof Ha?function(t){return xo(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Ba extends Pa{}class ja extends Pa{constructor(t){super(),this.elements=t}}function $a(t,e){const n=Ka(e);for(const e of t.elements)n.some((t=>So(t,e)))||n.push(e);return{arrayValue:{values:n}}}class za extends Pa{constructor(t){super(),this.elements=t}}function qa(t,e){let n=Ka(e);for(const e of t.elements)n=n.filter((t=>!So(t,e)));return{arrayValue:{values:n}}}class Ha extends Pa{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Ga(t){return mo(t.integerValue||t.doubleValue)}function Ka(t){return Oo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Qa{constructor(t,e){this.version=t,this.transformResults=e}}class Wa{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Wa}static exists(t){return new Wa(void 0,t)}static updateTime(t){return new Wa(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Xa(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Ja{}function Ya(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new hh(t.key,Wa.none()):new rh(t.key,t.data,Wa.none());{const n=t.data,r=Po.empty();let i=new ho(Ms.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new ih(t.key,r,new lo(i.toArray()),Wa.none())}}function Za(t,e,n){t instanceof rh?function(t,e,n){const r=t.value.clone(),i=oh(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof ih?function(t,e,n){if(!Xa(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=oh(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(sh(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function th(t,e,n,r){return t instanceof rh?function(t,e,n,r){if(!Xa(t.precondition,e))return n;const i=t.value.clone(),s=ah(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof ih?function(t,e,n,r){if(!Xa(t.precondition,e))return n;const i=ah(t.fieldTransforms,r,e),s=e.data;return s.setAll(sh(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,r):function(t,e,n){return Xa(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function eh(t,e){let n=null;for(const r of t.fieldTransforms){const t=e.data.field(r.field),i=Ua(r.transform,t||null);null!=i&&(null===n&&(n=Po.empty()),n.set(r.field,i))}return n||null}function nh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Ns(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ja&&e instanceof ja||t instanceof za&&e instanceof za?Ns(t.elements,e.elements,So):t instanceof Ha&&e instanceof Ha?So(t.Ie,e.Ie):t instanceof Ba&&e instanceof Ba}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rh extends Ja{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ih extends Ja{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function sh(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function oh(t,e,n){const r=new Map;fs(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Fa(o,a,n[i]))}return r}function ah(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,Va(t,s,e))}return r}class hh extends Ja{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ch extends Ja{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lh{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const r=this.mutations[e];r.key.isEqual(t.key)&&Za(r,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=th(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=th(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ca();return this.mutations.forEach((r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=Ya(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(xs.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),xa())}isEqual(t){return this.batchId===t.batchId&&Ns(this.mutations,t.mutations,((t,e)=>nh(t,e)))&&Ns(this.baseMutations,t.baseMutations,((t,e)=>nh(t,e)))}}class uh{constructor(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}static from(t,e,n){fs(t.mutations.length===n.length);let r=Na;const i=t.mutations;for(let t=0;t<i.length;t++)r=r.insert(i[t].key,n[t].version);return new uh(t,e,n,r)}}class dh{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var fh,ph;(ph=fh||(fh={}))[ph.OK=0]="OK",ph[ph.CANCELLED=1]="CANCELLED",ph[ph.UNKNOWN=2]="UNKNOWN",ph[ph.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ph[ph.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ph[ph.NOT_FOUND=5]="NOT_FOUND",ph[ph.ALREADY_EXISTS=6]="ALREADY_EXISTS",ph[ph.PERMISSION_DENIED=7]="PERMISSION_DENIED",ph[ph.UNAUTHENTICATED=16]="UNAUTHENTICATED",ph[ph.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ph[ph.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ph[ph.ABORTED=10]="ABORTED",ph[ph.OUT_OF_RANGE=11]="OUT_OF_RANGE",ph[ph.UNIMPLEMENTED=12]="UNIMPLEMENTED",ph[ph.INTERNAL=13]="INTERNAL",ph[ph.UNAVAILABLE=14]="UNAVAILABLE",ph[ph.DATA_LOSS=15]="DATA_LOSS",new ns([4294967295,4294967295],0),Error;class gh{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function mh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yh(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function vh(t,e){return mh(t,e.toTimestamp())}function wh(t){return fs(!!t),xs.fromTimestamp(function(t){const e=go(t);return new ks(e.seconds,e.nanos)}(t))}function bh(t,e){return Eh(t,e).canonicalString()}function Eh(t,e){const n=function(t){return new Rs(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Th(t,e){return bh(t.databaseId,e.path)}function _h(t){const e=function(t){const e=Rs.fromString(t);return fs(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?Rs.emptyPath():function(t){return fs(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function Ih(t,e,n){return{name:Th(t,e),fields:n.value.mapValue.fields}}function Sh(t){let e=_h(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){fs(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=Ah(t);return e instanceof Go&&Qo(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new $o(Ch(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,to(e)?null:e}(n.limit));let h=null;n.startAt&&(h=function(t){const e=!!t.before,n=t.values||[];return new Uo(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new Uo(n,e)}(n.endAt)),function(t,e,n,r,i,s,o,a){return new la(t,e,n,r,i,s,o,a)}(e,i,o,s,a,"F",h,c)}function Ah(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ch(t.unaryFilter.field);return Ho.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ch(t.unaryFilter.field);return Ho.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ch(t.unaryFilter.field);return Ho.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ch(t.unaryFilter.field);return Ho.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ds()}}(t):void 0!==t.fieldFilter?function(t){return Ho.create(Ch(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ds()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Go.create(t.compositeFilter.filters.map((t=>Ah(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ds()}}(t.compositeFilter.op))}(t):ds()}function Ch(t){return Ms.fromServerFormat(t.fieldPath)}function Dh(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class Nh{constructor(t){this.ct=t}}function kh(t){const e=Sh({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?pa(e,e.limit,"L"):e}class xh{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(mo(t.integerValue));else if("doubleValue"in t){const n=mo(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),eo(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(yo(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?Mo(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):ds()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),Ps.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}xh.bt=new xh;class Oh{constructor(){this._n=new Rh}addToCollectionParentIndex(t,e){return this._n.add(e),zs.resolve()}getCollectionParents(t,e){return zs.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return zs.resolve()}deleteFieldIndex(t,e){return zs.resolve()}deleteAllFieldIndexes(t){return zs.resolve()}createTargetIndexes(t,e){return zs.resolve()}getDocumentsMatchingTarget(t,e){return zs.resolve(null)}getIndexType(t,e){return zs.resolve(0)}getFieldIndexes(t,e){return zs.resolve([])}getNextCollectionGroupToUpdate(t){return zs.resolve(null)}getMinOffset(t,e){return zs.resolve(Fs.min())}getMinOffsetFromCollectionGroup(t,e){return zs.resolve(Fs.min())}updateCollectionGroup(t,e,n){return zs.resolve()}updateIndexEntries(t,e){return zs.resolve()}}class Rh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ho(Rs.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new ho(Rs.comparator)).toArray()}}new Uint8Array(0);class Lh{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Lh(t,Lh.DEFAULT_COLLECTION_PERCENTILE,Lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Lh.DEFAULT_COLLECTION_PERCENTILE=10,Lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lh.DEFAULT=new Lh(41943040,Lh.DEFAULT_COLLECTION_PERCENTILE,Lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lh.DISABLED=new Lh(-1,0,0);class Mh{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Mh(0)}static Ln(){return new Mh(-1)}}class Ph{constructor(){this.changes=new ba((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Fo.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?zs.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Vh{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Fh{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((r=>(n=r,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&th(n.mutation,t,lo.empty(),ks.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,xa()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=xa()){const r=Aa();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,n).next((t=>{let e=Ia();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Aa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,xa())))}populateOverlays(t,e,n){const r=[];return n.forEach((t=>{e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,r){let i=Ta();const s=Da(),o=Da();return e.forEach(((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof ih)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),th(o.mutation,e,o.mutation.getFieldMask(),ks.now())):s.set(e.key,lo.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new Vh(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=Da();let r=new so(((t,e)=>t-e)),i=xa();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||lo.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||xa()).add(t);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,h=r.value,c=Ca();h.forEach((t=>{if(!i.has(t)){const r=Ya(e.get(t),n.get(t));null!==r&&c.set(t,r),i=i.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,c))}return zs.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return Ps.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):zs.resolve(Aa());let o=-1,a=i;return s.next((e=>zs.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?zs.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,xa()))).next((t=>({batchId:o,changes:Sa(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ps(e)).next((t=>{let e=Ia();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=Ia();return this.indexManager.getCollectionParents(t,i).next((o=>zs.forEach(o,(o=>{const a=function(t,e){return new la(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r)))).next((t=>{i.forEach(((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,Fo.newInvalidDocument(r)))}));let n=Ia();return t.forEach(((t,r)=>{const s=i.get(t);void 0!==s&&th(s.mutation,r,lo.empty(),ks.now()),va(e,r)&&(n=n.insert(t,r))})),n}))}}class Uh{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return zs.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:wh(t.createTime)}}(e)),zs.resolve()}getNamedQuery(t,e){return zs.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:kh(t.bundledQuery),readTime:wh(t.readTime)}}(e)),zs.resolve()}}class Bh{constructor(){this.overlays=new so(Ps.comparator),this.hr=new Map}getOverlay(t,e){return zs.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Aa();return zs.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,r)=>{this.ht(t,e,r)})),zs.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),zs.resolve()}getOverlaysForCollection(t,e,n){const r=Aa(),i=e.length+1,s=new Ps(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return zs.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new so(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=Aa(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Aa(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=r)););return zs.resolve(o)}ht(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new dh(e,n));let i=this.hr.get(e);void 0===i&&(i=xa(),this.hr.set(e,i)),this.hr.set(e,i.add(n.key))}}class jh{constructor(){this.Pr=new ho($h.Ir),this.Tr=new ho($h.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new $h(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new $h(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new Ps(new Rs([])),n=new $h(e,t),r=new $h(e,t+1),i=[];return this.Tr.forEachInRange([n,r],(t=>{this.Ar(t),i.push(t.key)})),i}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new Ps(new Rs([])),n=new $h(e,t),r=new $h(e,t+1);let i=xa();return this.Tr.forEachInRange([n,r],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new $h(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class $h{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return Ps.comparator(t.key,e.key)||Ds(t.pr,e.pr)}static Er(t,e){return Ds(t.pr,e.pr)||Ps.comparator(t.key,e.key)}}class zh{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new ho($h.Ir)}checkEmpty(t){return zs.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new lh(i,e,n,r);this.mutationQueue.push(s);for(const e of r)this.wr=this.wr.add(new $h(e.key,i)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return zs.resolve(s)}lookupMutationBatch(t,e){return zs.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.br(n),i=r<0?0:r;return zs.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return zs.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return zs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new $h(e,0),r=new $h(e,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(t=>{const e=this.Sr(t.pr);i.push(e)})),zs.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ho(Ds);return e.forEach((t=>{const e=new $h(t,0),r=new $h(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,r],(t=>{n=n.add(t.pr)}))})),zs.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;Ps.isDocumentKey(i)||(i=i.child(""));const s=new $h(new Ps(i),0);let o=new ho(Ds);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.pr)),!0)}),s),zs.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){fs(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return zs.forEach(e.mutations,(r=>{const i=new $h(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new $h(e,0),r=this.wr.firstAfterOrEqual(n);return zs.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,zs.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class qh{constructor(t){this.vr=t,this.docs=new so(Ps.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return zs.resolve(n?n.document.mutableCopy():Fo.newInvalidDocument(e))}getEntries(t,e){let n=Ta();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Fo.newInvalidDocument(t))})),zs.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=Ta();const s=e.path,o=new Ps(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||Us(Vs(o),n)<=0||(r.has(o.key)||va(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return zs.resolve(i)}getAllFromCollectionGroup(t,e,n,r){ds()}Fr(t,e){return zs.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Hh(this)}getSize(t){return zs.resolve(this.size)}}class Hh extends Ph{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?e.push(this.ar.addEntry(t,r)):this.ar.removeEntry(n)})),zs.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Gh{constructor(t){this.persistence=t,this.Mr=new ba((t=>ha(t)),ca),this.lastRemoteSnapshotVersion=xs.min(),this.highestTargetId=0,this.Or=0,this.Nr=new jh,this.targetCount=0,this.Lr=Mh.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),zs.resolve()}getLastRemoteSnapshotVersion(t){return zs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return zs.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Lr.next(),zs.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),zs.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Lr=new Mh(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,zs.resolve()}updateTargetData(t,e){return this.qn(e),zs.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,zs.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)})),zs.waitFor(i).next((()=>r))}getTargetCount(t){return zs.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return zs.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),zs.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((e=>{i.push(r.markPotentiallyOrphaned(t,e))})),zs.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),zs.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return zs.resolve(n)}containsKey(t,e){return zs.resolve(this.Nr.containsKey(e))}}class Kh{constructor(t,e){this.Br={},this.overlays={},this.kr=new Zs(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Gh(this),this.indexManager=new Oh,this.remoteDocumentCache=function(t){return new qh(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new Nh(e),this.$r=new Uh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Bh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Br[t.toKey()];return n||(n=new zh(e,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){hs("MemoryPersistence","Starting transaction:",t);const r=new Qh(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((t=>this.referenceDelegate.Wr(r).next((()=>t)))).toPromise().then((t=>(r.raiseOnCommittedEvent(),t)))}Gr(t,e){return zs.or(Object.values(this.Br).map((n=>()=>n.containsKey(t,e))))}}class Qh extends js{constructor(t){super(),this.currentSequenceNumber=t}}class Wh{constructor(t){this.persistence=t,this.zr=new jh,this.jr=null}static Hr(t){return new Wh(t)}get Jr(){if(this.jr)return this.jr;throw ds()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),zs.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),zs.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),zs.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return zs.forEach(this.Jr,(n=>{const r=Ps.fromPath(n);return this.Yr(t,r).next((t=>{t||e.removeEntry(r,xs.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return zs.or([()=>zs.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class Xh{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=r}static Ki(t,e){let n=xa(),r=xa();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new Xh(t,e.fromCache,n,r)}}class Jh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Yh{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var t;const e=null===(t=s())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Hs.v(h())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.ji(t,e).next((t=>{i.result=t})).next((()=>{if(!i.result)return this.Hi(t,e,r,n).next((t=>{i.result=t}))})).next((()=>{if(i.result)return;const n=new Jh;return this.Ji(t,e,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(t,e,n,r.size)}))})).next((()=>i.result))}Yi(t,e,n,r){return n.documentReadCount<this.Wi?(as()<=E.DEBUG&&hs("QueryEngine","SDK will not create cache indexes for query:",ya(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),zs.resolve()):(as()<=E.DEBUG&&hs("QueryEngine","Query:",ya(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(as()<=E.DEBUG&&hs("QueryEngine","The SDK decides to create cache indexes for query:",ya(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,fa(e))):zs.resolve())}ji(t,e){if(ua(e))return zs.resolve(null);let n=fa(e);return this.indexManager.getIndexType(t,n).next((r=>0===r?null:(null!==e.limit&&1===r&&(e=pa(e,null,"F"),n=fa(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((r=>{const i=xa(...r);return this.zi.getDocuments(t,i).next((r=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,r);return this.Xi(e,s,i,n.readTime)?this.ji(t,pa(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,r){return ua(e)||r.isEqual(xs.min())?zs.resolve(null):this.zi.getDocuments(t,n).next((i=>{const s=this.Zi(e,i);return this.Xi(e,s,n,r)?zs.resolve(null):(as()<=E.DEBUG&&hs("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ya(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=xs.fromTimestamp(1e9===r?new ks(n+1,0):new ks(n,r));return new Fs(i,Ps.empty(),e)}(r,-1)).next((t=>t)))}))}Zi(t,e){let n=new ho(function(t){return(e,n)=>{let r=!1;for(const i of da(t)){const t=wa(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}(t));return e.forEach(((e,r)=>{va(t,r)&&(n=n.add(r))})),n}Xi(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(t,e,n){return as()<=E.DEBUG&&hs("QueryEngine","Using full collection scan to execute query:",ya(e)),this.zi.getDocumentsMatchingQuery(t,e,Fs.min(),n)}es(t,e,n,r){return this.zi.getDocumentsMatchingQuery(t,n,r).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Zh{constructor(t,e,n,r){this.persistence=t,this.ts=e,this.serializer=r,this.ns=new so(Ds),this.rs=new ba((t=>ha(t)),ca),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Fh(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function tc(t,e){const n=ps(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next((i=>(r=i,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],s=[];let o=xa();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:i,addedBatchIds:s})))}))}))}function ec(t,e){const n=ps(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class nc{constructor(){this.activeTargetIds=Oa}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class rc{constructor(){this.no=new nc,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new nc,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class ic{io(t){}shutdown(){}}class sc{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){hs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){hs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let oc=null;function ac(){return null===oc?oc=268435456+Math.round(2147483648*Math.random()):oc++,"0x"+oc.toString(16)}const hc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cc{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const lc="WebChannelConnection";class uc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(t,e,n,r,i){const s=ac(),o=this.bo(t,e.toUriEncodedString());hs("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(t,o,a,n).then((e=>(hs("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw ls("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,r,i,s){return this.So(t,e,n,r,i)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ss,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=hc[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,r){const i=ac();return new Promise(((s,o)=>{const a=new es;a.setWithCredentials(!0),a.listenOnce(Ji.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Xi.NO_ERROR:const e=a.getResponseJson();hs(lc,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(e)),s(e);break;case Xi.TIMEOUT:hs(lc,`RPC '${t}' ${i} timed out`),o(new ms(gs.DEADLINE_EXCEEDED,"Request time out"));break;case Xi.HTTP_ERROR:const n=a.getStatus();if(hs(lc,`RPC '${t}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(gs).indexOf(e)>=0?e:gs.UNKNOWN}(e.status);o(new ms(t,e.message))}else o(new ms(gs.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ms(gs.UNAVAILABLE,"Connection failed."));break;default:ds()}}finally{hs(lc,`RPC '${t}' ${i} completed.`)}}));const h=JSON.stringify(r);hs(lc,`RPC '${t}' ${i} sending request:`,r),a.send(e,"POST",h,n,15)}))}Fo(t,e,n){const r=ac(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Qi(),o=Wi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;void 0!==h&&(a.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const c=i.join("");hs(lc,`Creating RPC '${t}' stream ${r}: ${c}`,a);const l=s.createWebChannel(c,a);let u=!1,d=!1;const f=new cc({lo:e=>{d?hs(lc,`Not sending because RPC '${t}' stream ${r} is closed:`,e):(u||(hs(lc,`Opening RPC '${t}' stream ${r} transport.`),l.open(),u=!0),hs(lc,`RPC '${t}' stream ${r} sending:`,e),l.send(e))},ho:()=>l.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(l,ts.EventType.OPEN,(()=>{d||hs(lc,`RPC '${t}' stream ${r} transport opened.`)})),p(l,ts.EventType.CLOSE,(()=>{d||(d=!0,hs(lc,`RPC '${t}' stream ${r} transport closed`),f.Vo())})),p(l,ts.EventType.ERROR,(e=>{d||(d=!0,ls(lc,`RPC '${t}' stream ${r} transport errored:`,e),f.Vo(new ms(gs.UNAVAILABLE,"The operation could not be completed")))})),p(l,ts.EventType.MESSAGE,(e=>{var n;if(!d){const i=e.data[0];fs(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){hs(lc,`RPC '${t}' stream ${r} received error:`,o);const e=o.status;let n=function(t){const e=fh[t];if(void 0!==e)return function(t){if(void 0===t)return cs("GRPC error has no .code"),gs.UNKNOWN;switch(t){case fh.OK:return gs.OK;case fh.CANCELLED:return gs.CANCELLED;case fh.UNKNOWN:return gs.UNKNOWN;case fh.DEADLINE_EXCEEDED:return gs.DEADLINE_EXCEEDED;case fh.RESOURCE_EXHAUSTED:return gs.RESOURCE_EXHAUSTED;case fh.INTERNAL:return gs.INTERNAL;case fh.UNAVAILABLE:return gs.UNAVAILABLE;case fh.UNAUTHENTICATED:return gs.UNAUTHENTICATED;case fh.INVALID_ARGUMENT:return gs.INVALID_ARGUMENT;case fh.NOT_FOUND:return gs.NOT_FOUND;case fh.ALREADY_EXISTS:return gs.ALREADY_EXISTS;case fh.PERMISSION_DENIED:return gs.PERMISSION_DENIED;case fh.FAILED_PRECONDITION:return gs.FAILED_PRECONDITION;case fh.ABORTED:return gs.ABORTED;case fh.OUT_OF_RANGE:return gs.OUT_OF_RANGE;case fh.UNIMPLEMENTED:return gs.UNIMPLEMENTED;case fh.DATA_LOSS:return gs.DATA_LOSS;default:return ds()}}(e)}(e),i=o.message;void 0===n&&(n=gs.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new ms(n,i)),l.close()}else hs(lc,`RPC '${t}' stream ${r} received:`,i),f.mo(i)}})),p(o,Yi.STAT_EVENT,(e=>{e.stat===Zi.PROXY?hs(lc,`RPC '${t}' stream ${r} detected buffering proxy`):e.stat===Zi.NOPROXY&&hs(lc,`RPC '${t}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function dc(){return"undefined"!=typeof document?document:null}function fc(t){return new gh(t,!0)}class pc{constructor(t,e,n=1e3,r=1.5,i=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,e-n);r>0&&hs("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class gc{constructor(t,e,n,r,i,s,o,a){this.oi=t,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new pc(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===gs.RESOURCE_EXHAUSTED?(cs(e.toString()),cs("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===gs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new ms(gs.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return hs("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(hs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class mc extends gc{constructor(t,e,n,r,i,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(fs(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(fs(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?wh(t.updateTime):wh(e);return n.isEqual(xs.min())&&(n=wh(e)),new Qa(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=wh(t.commitTime);return this.listener.T_(n,e)}return fs(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=function(t){return new Rs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof rh)n={update:Ih(t,e.key,e.value)};else if(e instanceof hh)n={delete:Th(t,e.key)};else if(e instanceof ih)n={update:Ih(t,e.key,e.data),updateMask:Dh(e.fieldMask)};else{if(!(e instanceof ch))return ds();n={verify:Th(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Ba)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ja)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof za)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ha)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw ds()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:vh(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ds()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class yc extends class{}{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new ms(gs.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.So(t,Eh(e,n),r,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===gs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new ms(gs.UNKNOWN,t.toString())}))}vo(t,e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,Eh(e,n),r,s,o,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===gs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new ms(gs.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class vc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(cs(e),this.g_=!1):hs("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class wc{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((t=>{n.enqueueAndForget((async()=>{Tc(this)&&(hs("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=ps(t);e.v_.add(4),await Ec(e),e.x_.set("Unknown"),e.v_.delete(4),await bc(e)}(this))}))})),this.x_=new vc(n,r)}}async function bc(t){if(Tc(t))for(const e of t.F_)await e(!0)}async function Ec(t){for(const e of t.F_)await e(!1)}function Tc(t){return 0===ps(t).v_.size}async function _c(t,e,n){if(!Qs(e))throw e;t.v_.add(1),await Ec(t),t.x_.set("Offline"),n||(n=()=>function(t){const e=ps(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{hs("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await bc(t)}))}function Ic(t,e){return e().catch((n=>_c(t,n,e)))}async function Sc(t){const e=ps(t),n=Mc(e);let r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Ac(e);)try{const t=await ec(e.localStore,r);if(null===t){0===e.D_.length&&n.Xo();break}r=t.batchId,Cc(e,t)}catch(t){await _c(e,t)}Dc(e)&&Nc(e)}function Ac(t){return Tc(t)&&t.D_.length<10}function Cc(t,e){t.D_.push(e);const n=Mc(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function Dc(t){return Tc(t)&&!Mc(t).Ho()&&t.D_.length>0}function Nc(t){Mc(t).start()}async function kc(t){Mc(t).d_()}async function xc(t){const e=Mc(t);for(const n of t.D_)e.I_(n.mutations)}async function Oc(t,e,n){const r=t.D_.shift(),i=uh.from(r,e,n);await Ic(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await Sc(t)}async function Rc(t,e){e&&Mc(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return ds();case gs.CANCELLED:case gs.UNKNOWN:case gs.DEADLINE_EXCEEDED:case gs.RESOURCE_EXHAUSTED:case gs.INTERNAL:case gs.UNAVAILABLE:case gs.UNAUTHENTICATED:return!1;case gs.INVALID_ARGUMENT:case gs.NOT_FOUND:case gs.ALREADY_EXISTS:case gs.PERMISSION_DENIED:case gs.FAILED_PRECONDITION:case gs.ABORTED:case gs.OUT_OF_RANGE:case gs.UNIMPLEMENTED:case gs.DATA_LOSS:return!0}}(t)&&t!==gs.ABORTED}(e.code)){const n=t.D_.shift();Mc(t).Zo(),await Ic(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Sc(t)}}(t,e),Dc(t)&&Nc(t)}async function Lc(t,e){const n=ps(t);n.asyncQueue.verifyOperationInProgress(),hs("RemoteStore","RemoteStore received new credentials");const r=Tc(n);n.v_.add(3),await Ec(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await bc(n)}function Mc(t){return t.L_||(t.L_=function(t,e,n){const r=ps(t);return r.R_(),new mc(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Po:kc.bind(null,t),To:Rc.bind(null,t),E_:xc.bind(null,t),T_:Oc.bind(null,t)}),t.F_.push((async e=>{e?(t.L_.Zo(),await Sc(t)):(await t.L_.stop(),t.D_.length>0&&(hs("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}class Pc{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new Pc(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ms(gs.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vc(t,e){if(cs("AsyncQueue",`${e}: ${t}`),Qs(t))return new ms(gs.UNAVAILABLE,`${e}: ${t}`);throw t}class Fc{constructor(){this.queries=new ba((t=>ma(t)),ga),this.onlineState="Unknown",this.W_=new Set}}var Uc,Bc;(Bc=Uc||(Uc={})).j_="default",Bc.Cache="cache";class jc{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.ya={},this.wa=new ba((t=>ma(t)),ga),this.Sa=new Map,this.ba=new Set,this.Da=new so(Ps.comparator),this.Ca=new Map,this.va=new jh,this.Fa={},this.Ma=new Map,this.xa=Mh.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}function $c(t,e,n){const r=ps(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.wa.forEach(((n,r)=>{const i=r.view.G_(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=ps(t);n.onlineState=e;let r=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.G_(e)&&(r=!0)})),r&&function(t){t.W_.forEach((t=>{t.next()}))}(n)}(r.eventManager,e),t.length&&r.ya.u_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function zc(t,e){const n=ps(t),r=e.batch.batchId;try{const t=await function(t,e){const n=ps(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const r=e.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){const i=n.batch,s=i.keys();let o=zs.resolve();return s.forEach((t=>{o=o.next((()=>r.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);fs(null!==s),e.version.compareTo(s)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=xa();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(n.localStore,e);Gc(n,r,null),Hc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Kc(n,t)}catch(t){await $s(t)}}async function qc(t,e,n){const r=ps(t);try{const t=await function(t,e){const n=ps(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let r;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(fs(null!==e),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(r.localStore,e);Gc(r,e,n),Hc(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Kc(r,t)}catch(n){await $s(n)}}function Hc(t,e){(t.Ma.get(e)||[]).forEach((t=>{t.resolve()})),t.Ma.delete(e)}function Gc(t,e,n){const r=ps(t);let i=r.Fa[r.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}async function Kc(t,e,n){const r=ps(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach(((t,a)=>{o.push(r.Na(a,e,n).then((t=>{if((t||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=Xh.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),r.ya.u_(i),await async function(t,e){const n=ps(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>zs.forEach(e,(e=>zs.forEach(e.qi,(r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r))).next((()=>zs.forEach(e.Qi,(r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))))))}catch(t){if(!Qs(t))throw t;hs("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,i)}}}(r.localStore,s))}async function Qc(t,e){const n=ps(t);if(!n.currentUser.isEqual(e)){hs("SyncEngine","User change. New user:",e.toKey());const t=await tc(n.localStore,e);n.currentUser=e,function(t,e){t.Ma.forEach((t=>{t.forEach((t=>{t.reject(new ms(gs.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ma.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Kc(n,t.us)}}function Wc(t){const e=ps(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zc.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qc.bind(null,e),e}class Xc{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=fc(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,r){return new Zh(t,e,n,r)}(this.persistence,new Yh,t.initialUser,this.serializer)}createPersistence(t){return new Kh(Wh.Hr,this.serializer)}createSharedClientState(t){return new rc}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Jc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>$c(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qc.bind(null,this.syncEngine),await async function(t,e){const n=ps(t);e?(n.v_.delete(2),await bc(n)):e||(n.v_.add(2),await Ec(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Fc}createDatastore(t){const e=fc(t.databaseInfo.databaseId),n=function(t){return new uc(t)}(t.databaseInfo);return function(t,e,n,r){return new yc(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new wc(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,(t=>$c(this.syncEngine,t,0)),sc.D()?new sc:new ic)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new jc(t,e,n,r,i,s);return o&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=ps(t);hs("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await Ec(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class Yc{constructor(t,e,n,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=is.UNAUTHENTICATED,this.clientId=Cs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{hs("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(hs("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ms(gs.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Vc(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Zc(t,e){t.asyncQueue.verifyOperationInProgress(),hs("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async t=>{r.isEqual(t)||(await tc(e.localStore,t),r=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function tl(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){hs("FirestoreClient","Using user provided OfflineComponentProvider");try{await Zc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===gs.FAILED_PRECONDITION||t.code===gs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;ls("Error using user provided cache. Falling back to memory cache: "+n),await Zc(t,new Xc)}}else hs("FirestoreClient","Using default OfflineComponentProvider"),await Zc(t,new Xc);return t._offlineComponents}(t);hs("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Lc(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Lc(e.remoteStore,n))),t._onlineComponents=e}function el(t){return async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(hs("FirestoreClient","Using user provided OnlineComponentProvider"),await tl(t,t._uninitializedComponentsProvider._online)):(hs("FirestoreClient","Using default OnlineComponentProvider"),await tl(t,new Jc))),t._onlineComponents}(t).then((t=>t.syncEngine))}function nl(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const rl=new Map;function il(t,e,n){if(!n)throw new ms(gs.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sl(t){if(!Ps.isDocumentKey(t))throw new ms(gs.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ol(t){if(Ps.isDocumentKey(t))throw new ms(gs.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function al(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":ds()}function hl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ms(gs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=al(t);throw new ms(gs.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class cl{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new ms(gs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ms(gs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new ms(gs.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nl(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new ms(gs.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new ms(gs.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new ms(gs.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ll{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ms(gs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new ms(gs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cl(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new ws;switch(t.type){case"firstParty":return new _s(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new ms(gs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=rl.get(t);e&&(hs("ComponentProvider","Removing Datastore"),rl.delete(t),e.terminate())}(this),Promise.resolve()}}class ul{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ul(this.firestore,t,this._query)}}class dl{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fl(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new dl(this.firestore,t,this._key)}}class fl extends ul{constructor(t,e,n){super(t,e,function(t){return new la(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new dl(this.firestore,null,new Ps(t))}withConverter(t){return new fl(this.firestore,t,this._path)}}class pl{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new pc(this,"async_queue_retry"),this.cu=()=>{const t=dc();t&&hs("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=dc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.lu(),this.hu(t)}enterRestrictedMode(t){if(!this.iu){this.iu=!0,this.au=t||!1;const e=dc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.cu)}}enqueue(t){if(this.lu(),this.iu)return new Promise((()=>{}));const e=new ys;return this.hu((()=>this.iu&&this.au?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.ru.push(t),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(t){if(!Qs(t))throw t;hs("AsyncQueue","Operation failed with retryable error: "+t)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(t){const e=this.nu.then((()=>(this._u=!0,t().catch((t=>{this.ou=t,this._u=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw cs("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this._u=!1,t))))));return this.nu=e,e}enqueueAfterDelay(t,e,n){this.lu(),this.uu.indexOf(t)>-1&&(e=0);const r=Pc.createAndSchedule(this,t,e,n,(t=>this.Iu(t)));return this.su.push(r),r}lu(){this.ou&&ds()}verifyOperationInProgress(){}async Tu(){let t;do{t=this.nu,await t}while(t!==this.nu)}Eu(t){for(const e of this.su)if(e.timerId===t)return!0;return!1}du(t){return this.Tu().then((()=>{this.su.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.su)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Tu()}))}Au(t){this.uu.push(t)}Iu(t){const e=this.su.indexOf(t);this.su.splice(e,1)}}class gl extends ll{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new pl,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ml(this),this._firestoreClient.terminate()}}function ml(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new Eo(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,nl(r.experimentalLongPollingOptions),r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new Yc(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class yl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new yl(fo.fromBase64String(t))}catch(t){throw new ms(gs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new yl(fo.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class vl{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new ms(gs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ms(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class wl{constructor(t){this._methodName=t}}class bl{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new ms(gs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ms(gs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Ds(this._lat,t._lat)||Ds(this._long,t._long)}}const El=/^__.*__$/;class Tl{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new ih(t,this.data,this.fieldMask,e,this.fieldTransforms):new rh(t,this.data,e,this.fieldTransforms)}}function _l(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ds()}}class Il{constructor(t,e,n,r,i,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ru(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(t){return new Il(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mu({path:n,gu:!1});return r.pu(t),r}yu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mu({path:n,gu:!1});return r.Ru(),r}wu(t){return this.mu({path:void 0,gu:!0})}Su(t){return Ll(t,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Ru(){if(this.path)for(let t=0;t<this.path.length;t++)this.pu(this.path.get(t))}pu(t){if(0===t.length)throw this.Su("Document fields must not be empty");if(_l(this.Vu)&&El.test(t))throw this.Su('Document fields cannot begin and end with "__"')}}class Sl{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||fc(t)}Cu(t,e,n,r=!1){return new Il({Vu:t,methodName:e,Du:n,path:Ms.emptyPath(),gu:!1,bu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Al(t){const e=t._freezeSettings(),n=fc(t._databaseId);return new Sl(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Cl(t,e,n,r,i,s={}){const o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);xl("Data must be an object, but it was:",o,r);const a=Nl(r,o);let h,c;if(s.merge)h=new lo(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=Ol(e,r,n);if(!o.contains(i))throw new ms(gs.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ml(t,i)||t.push(i)}h=new lo(t),c=o.fieldTransforms.filter((t=>h.covers(t.field)))}else h=null,c=o.fieldTransforms;return new Tl(new Po(a),h,c)}function Dl(t,e){if(kl(t=g(t)))return xl("Unsupported field value:",e,t),Nl(t,e);if(t instanceof wl)return function(t,e){if(!_l(e.Vu))throw e.Su(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Su(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&4!==e.Vu)throw e.Su("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=Dl(i,e.wu(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=g(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ma(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=ks.fromDate(t);return{timestampValue:mh(e.serializer,n)}}if(t instanceof ks){const n=new ks(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:mh(e.serializer,n)}}if(t instanceof bl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof yl)return{bytesValue:yh(e.serializer,t._byteString)};if(t instanceof dl){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Su(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:bh(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Su(`Unsupported field value: ${al(t)}`)}(t,e)}function Nl(t,e){const n={};return io(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ro(t,((t,r)=>{const i=Dl(r,e.fu(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function kl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ks||t instanceof bl||t instanceof yl||t instanceof dl||t instanceof wl)}function xl(t,e,n){if(!kl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=al(n);throw"an object"===r?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function Ol(t,e,n){if((e=g(e))instanceof vl)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(Rl)>=0)throw Ll(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new vl(...e.split("."))._internalPath}catch(r){throw Ll(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw Ll("Field path arguments must be of type string or ",t,!1,void 0,n)}const Rl=new RegExp("[~\\*/\\[\\]]");function Ll(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let h="";return(s||o)&&(h+=" (found",s&&(h+=` in field ${r}`),o&&(h+=` in document ${i}`),h+=")"),new ms(gs.INVALID_ARGUMENT,a+t+h)}function Ml(t,e){return t.some((t=>t.isEqual(e)))}function Pl(t,e){const n=hl(t.firestore,gl),r=function(t,e,...n){if(t=g(t),1===arguments.length&&(e=Cs.newId()),il("doc","path",e),t instanceof ll){const r=Rs.fromString(e,...n);return sl(r),new dl(t,null,new Ps(r))}{if(!(t instanceof dl||t instanceof fl))throw new ms(gs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Rs.fromString(e,...n));return sl(r),new dl(t.firestore,t instanceof fl?t.converter:null,new Ps(r))}}(t),i=function(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}(t.converter,e);return function(t,e){return function(t,e){const n=new ys;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const r=Wc(t);try{const t=await function(t,e){const n=ps(t),r=ks.now(),i=e.reduce(((t,e)=>t.add(e.key)),xa());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Ta(),h=xa();return n.os.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(h=h.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{s=i;const o=[];for(const t of e){const e=eh(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new ih(t.key,e,Vo(e.value.mapValue),Wa.exists(!0)))}return n.mutationQueue.addMutationBatch(t,r,o,e)})).next((e=>{o=e;const r=e.applyToLocalDocumentSet(s,h);return n.documentOverlayCache.saveOverlays(t,e.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Sa(s)})))}(r.localStore,e);r.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let r=t.Fa[t.currentUser.toKey()];r||(r=new so(Ds)),r=r.insert(e,n),t.Fa[t.currentUser.toKey()]=r}(r,t.batchId,n),await Kc(r,t.changes),await Sc(r.remoteStore)}catch(t){const e=Vc(t,"Failed to persist write");n.reject(e)}}(await el(t),e,n))),n.promise}(function(t){return t._firestoreClient||ml(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[Cl(Al(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Wa.exists(!1))]).then((()=>r))}new WeakMap,function(t,e=!0){ss="10.9.0",_t(new m("firestore",((t,{instanceIdentifier:n,options:r})=>{const i=t.getProvider("app").getImmediate(),s=new gl(new Es(t.getProvider("auth-internal")),new Ss(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ms(gs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new To(t.options.projectId,e)}(i,n),i);return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),Ct(rs,"4.5.0",t),Ct(rs,"4.5.0","esm2017")}();const Vl=function(t,e){const n="string"==typeof t?t:"(default)",r=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}("object"==typeof t?t:function(t=vt){const e=bt.get(t);if(!e&&t===vt&&o())return At();if(!e)throw It.create("no-app",{appName:t});return e}(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=s())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]})("firestore");t&&function(t,e,n,r={}){var s;const o=(t=hl(t,ll))._getSettings(),a=`${e}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&ls("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=is.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[i(JSON.stringify({alg:"none",type:"JWT"})),i(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new ms(gs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new is(o)}t._authCredentials=new bs(new vs(e,n))}}(r,...t)}return r}(At({apiKey:"AIzaSyA-_mnUQ4kNNi61f71pe2gDONwYaqqzDKA",authDomain:"lab6-prueba.firebaseapp.com",projectId:"lab6-prueba",storageBucket:"lab6-prueba.appspot.com",messagingSenderId:"794296916530",appId:"1:794296916530:web:3ca7713fdbd351e267ba2b"}));var Fl=n(523);const Ul={name:"",color:"",letra:""};class Bl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}async render(){const t=this.ownerDocument.createElement("h1");t.innerText="Crea una publicacion",this.shadowRoot?.appendChild(t);const e=this.ownerDocument.createElement("input");e.type="color",e.addEventListener("change",this.addColor),this.shadowRoot?.appendChild(e);const n=this.ownerDocument.createElement("input");n.placeholder="Letra",n.addEventListener("change",this.addLetra),this.shadowRoot?.appendChild(n);const r=this.ownerDocument.createElement("button");r.innerHTML="Guardar publicacion",r.addEventListener("click",this.submitForm),this.shadowRoot?.appendChild(r),document.createElement("section");const i=this.ownerDocument.createElement("style");i.innerHTML=Fl.A,this.shadowRoot?.appendChild(i)}addNombre(t){Ul.name=t.target?.value}addColor(t){Ul.color=t.target?.value}addLetra(t){Ul.letra=t.target?.value}submitForm(){(async t=>{try{const e=await Pl(function(t,e,...n){if(t=g(t),il("collection","path",e),t instanceof ll){const r=Rs.fromString(e,...n);return ol(r),new fl(t,null,r)}{if(!(t instanceof dl||t instanceof fl))throw new ms(gs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Rs.fromString(e,...n));return ol(r),new fl(t.firestore,null,r)}}(Vl,"users"),t);console.log("Document written with ID: ",e.id)}catch(t){console.error("Error adding document: ",t)}})(Ul)}}customElements.define("app-container",Bl)})()})();